<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>


<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A1: Injection</p>   
		</div>
		<div class="">
               <a class="checkbox checkbox-one" style="float:right;" onclick="toggleall();">Expand/Collapse</a>               
            </div>
       		<table class="table" id="desc-table">
			  <tbody>
				<tr onClick="toggle();"><th colspan="2" id="desc-table-header" ><a href="#" class="desc-table-header">Threat Agents</a></th></tr>
				<tr id="hidethis1"><th colspan="2" class="table-title-grey">Application Specific</th></tr>
				<tr id="hidethis11">
				<td colspan="2">
						Consider anyone who can send untrusted data to the system, including external users, internal users, and administrators.
				</td></tr>
				
				<tr onClick="toggle2();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Attack Vectors</a></th></tr>
				<tr id="hidethis2"><th colspan="2" class="table-title-red">Exploitability EASY</th></tr>
				<tr id="hidethis22">
				<td colspan="2">
						Attacker sends simple text-based attacks that exploit the syntax of the targeted interpreter. Almost any source of data can be an injection vector, including internal sources.
				</td></tr>
				
				<tr onClick="toggle3();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Security Weakness</a></th></tr>
				<tr id="hidethis3">
					<th class="table-title-orange">Prevalence COMMON</th><th class="table-title-orange">Detectability AVERAGE</th>
				</tr>
				<tr id="hidethis33">
				<td colspan="2">
						Injection flaws occur when an application sends untrusted data to an interpreter. Injection flaws are very prevalent, particularly in legacy code. They are often found in SQL, LDAP, Xpath, or NoSQL queries; OS commands; XML parsers, SMTP Headers, program arguments, etc. Injection flaws are easy to discover when examining code, but frequently hard to discover via testing. Scanners and fuzzers can help attackers find injection flaws.
				</td></tr>
				
				<tr onClick="toggle4();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Technical Impacts</a></th></tr>
				<tr id="hidethis4"><th colspan="2" class="table-title-red">Impact SEVERE</th></tr>
				<tr id="hidethis44">
				<td colspan="2">
						Injection can result in data loss or corruption, lack of accountability, or denial of access. Injection can sometimes lead to complete host takeover.
				</td></tr>
				
				<tr onClick="toggle5();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Business Impacts</a></th></tr>
				<tr id="hidethis5"><th colspan="2" class="table-title-grey">Application / Business Specific</th></tr>
				<tr id="hidethis55"><td colspan="2">
				Consider the business value of the affected data and the platform running the interpreter. All data could be stolen, modified, or deleted. Could your reputation be harmed?
				</td></tr>
			  </tbody>
			</table>
			
				<div class="static-notification-blue">
					<p class="center-text uppercase">Am I Vulnerable To 'Injection'?</p>   
				</div>				
					
					<p>The best way to find out if an application is vulnerable to injection is to verify that all use of interpreters clearly separates untrusted data from the command or query. For SQL calls, this means using bind variables in all prepared statements and stored procedures, and avoiding dynamic queries.
					</p>
					<p>Checking the code is a fast and accurate way to see if the application uses interpreters safely. Code analysis tools can help a security analyst find the use of interpreters and trace the data flow through the application. Penetration testers can validate these issues by crafting exploits that confirm the vulnerability.
					</p>
					<p>Automated dynamic scanning which exercises the application may provide insight into whether some exploitable injection flaws exist. Scanners cannot always reach interpreters and have difficulty detecting whether an attack was successful. Poor error handling makes injection flaws easier to discover
					</p>
				<div class="decoration"></div>
					
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">How Do I Prevent 'Injection'?</p>   
				</div>											
				<p>Preventing injection requires keeping untrusted data separate from commands and queries.
				</p>
				<ol>
				<li> The preferred option is to use a safe API which avoids the use of the interpreter entirely or provides a parameterized interface.  Be careful with APIs, such as stored procedures, that are parameterized, but can still introduce injection under the hood.
				</li>
				<li> If a parameterized API is not available, you should carefully escape special characters using the specific escape syntax for that interpreter. <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/ESAPI');">OWASP’s ESAPI</a> has some of these <a id="hyperlink" href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Encoder.html');">escaping routines</a>.
				</li>
				<li> Positive or “white list” input validation is also recommended, but is not a complete defense as many applications require special characters in their input. If special characters are required, only approaches 1. and 2. above will make their use safe. <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/ESAPI');">OWASP’s ESAP</a> has an extensible library of <a id="hyperlink" href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Validator.html');">white list input validation routines</a>. 
				</li>
				</ol>
				<div class="decoration"></div>
				
				
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Example Attack Scenarios</p>   
				</div>	
				<p>The application uses untrusted data in the construction of the following vulnerable SQL call:
				</p>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;"><span style="color:red;">String query = "SELECT * FROM accounts WHERE custID='" + request.getParameter("id") +"'";</span></div>
				<p>The attacker modifies the 'id' parameter in their browser to send: ' or '1'='1. This changes the meaning of the query to return all the records from the accounts database, instead of only the intended customer's.
				</p>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">http://example.com/app/accountView?id=<span style="color: red;">' or '1'='1</span></div>
				<p>In the worst case, the attacker uses this weakness to invoke special stored procedures in the database, allowing a complete takeover of the database host.
				</p>

				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>				
				<p><b>OWASP</b>
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet');" title="SQL Injection Prevention Cheat Sheet"> OWASP SQL Injection Prevention Cheat Sheet</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Command_Injection');" title="Command Injection"> OWASP Injection Flaws Article</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Encoder.html');">ESAPI Encoder API</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Validator.html');">ESAPI Input Validation API</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://www.owasp.org/index.php/ASVS#tab=Downloads');">ASVS: Output Encoding/Escaping Requirements (V6)</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OWASP-DV-005)');" title="Testing for SQL Injection (OWASP-DV-005)"> OWASP Testing Guide: Chapter on SQL Injection Testing</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Reviewing_Code_for_SQL_Injection');" title="Reviewing Code for SQL Injection"> OWASP Code Review Guide: Chapter on SQL Injection</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Reviewing_Code_for_OS_Injection');" title="Reviewing Code for OS Injection"> OWASP Code Review Guide: Command Injection</a>
					</li>
					</ul>
				<p><b>External</b>
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/77.html');">CWE Entry 77 on Command Injection</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/89.html');">CWE Entry 89 on SQL Injection</a>
					</li>
					</ul>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


