<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A7: Insecure Cryptographic Storage</p>   
		</div>
		<div class="">
               <a class="checkbox checkbox-one" style="float:right;" onclick="toggleall();">Expand/Collapse</a>               
            </div>
       		<table class="table" id="desc-table">
			  <tbody>
				<tr onClick="toggle();"><th colspan="2" id="desc-table-header" ><a href="#" class="desc-table-header">Threat Agents</a></th></tr>
				<tr id="hidethis1"><th colspan="2" class="table-title-grey">Application Specific</th></tr>
				<tr id="hidethis11">
				<td colspan="2">
						Consider the users of your system. Would they like to gain access to protected data they aren’t authorized for? What about internal administrators?
				</td></tr>
				
				<tr onClick="toggle2();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Attack Vectors</a></th></tr>
				<tr id="hidethis2"><th colspan="2" class="table-title-yellow">Exploitability DIFFICULT</th></tr>
				<tr id="hidethis22">
				<td colspan="2">
						Attackers typically don’t break the crypto. They break something else, such as find keys, get cleartext copies of data, or access data via channels that automatically decrypt.
				</td></tr>
				
				<tr onClick="toggle3();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Security Weakness</a></th></tr>
				<tr id="hidethis3">
					<th class="table-title-yellow">Prevalence UNCOMMON</th><th class="table-title-yellow">Detectability DIFFICULT</th>
				</tr>
				<tr id="hidethis33">
				<td colspan="2">
					The most common flaw in this area is simply not encrypting data that deserves encryption. When encryption is employed, unsafe key generation and storage, not rotating keys, and weak algorithm usage is common. Use of weak or unsalted hashes to protect passwords is also common. External attackers have difficulty detecting such flaws due to limited access. They usually must exploit something else first to gain the needed access.
				</td></tr>
				
				<tr onClick="toggle4();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Technical Impacts</a></th></tr>
				<tr id="hidethis4"><th colspan="2" class="table-title-red">Impact SEVERE</th></tr>
				<tr id="hidethis44">
				<td colspan="2">
						Failure frequently compromises all data that should have been encrypted. Typically this information includes sensitive data such as health records, credentials, personal data, credit cards, etc.
				</td></tr>
				
				<tr onClick="toggle5();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Business Impacts</a></th></tr>
				<tr id="hidethis5"><th colspan="2" class="table-title-grey">Application / Business Specific</th></tr>
				<tr id="hidethis55"><td colspan="2">
						Consider the business value of the lost data and impact to your reputation. What is your legal liability if this data is exposed? Also consider the damage to your reputation.
			    </td></tr>
			  </tbody>
			</table>
			
				<div class="static-notification-blue">
					<p class="center-text uppercase">Am I Vulnerable To 'Insecure Cryptographic Storage'?</p>   
				</div>				
					<p>The first thing you have to determine is which data is sensitive enough to require encryption. For example, passwords, credit cards, health records, and personal information should be encrypted. For all such data, ensure:
					</p>
					<ol>
					<li> It is encrypted everywhere it is stored long term, particularly in backups of this data.
					</li>
					<li> Only authorized users can access decrypted copies of the data (i.e., access control – See <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Top_10_2010-A4');">A4</a> and <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Top_10_2010-A8');">A8</a>).
					</li>
					<li> A strong standard encryption algorithm is used.
					</li>
					<li>A strong key is generated, protected from unauthorized access, and key change is planned for.
					</li>
					</ol>
					<p>And more ... For a more complete set of problems to avoid, see the <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/ASVS');">ASVS requirements on Cryptography (V7)</a>.
					</p>
				<div class="decoration"></div>	
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">How Do I Prevent 'Missing Function Level Access Control'?</p>   
				</div>								
				<p>The full perils of unsafe cryptography are well beyond the scope of this Top 10. That said, for all sensitive data deserving encryption, do all of the following, at a minimum:
					</p>
					<ol>
					<li> Considering the threats you plan to protect this data from (e.g., insider attack, external user), make sure you encrypt all such data at rest in a manner that defends against these threats.
					</li>
					<li> Ensure offsite backups are encrypted, but the keys are managed and backed up separately.
					</li>
					<li> Ensure appropriate strong standard algorithms and strong keys are used, and key management is in place.
					</li>
					<li> Ensure passwords are hashed with a strong standard algorithm and an appropriate salt is used.
					</li>
					<li> Ensure all keys and passwords are protected from unauthorized access.
					</li>
					</ol>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Example Scenarios</p>   
				</div>	
					<p><b>Scenario #1</b>: An application encrypts credit cards in a database to prevent exposure to end users. However, the database is set to automatically decrypt queries against the credit card columns, allowing an SQL injection flaw to retrieve all the credit cards in cleartext. The system should have been configured to allow only back end applications to decrypt them, not the front end web application.
					</p><p><b>Scenario #2</b>: A backup tape is made of encrypted health records, but the encryption key is on the same backup. The tape never arrives at the backup center.
					</p><p><b>Scenario #3</b>: The password database uses unsalted hashes to store everyone’s passwords. A file upload flaw allows an attacker to retrieve the password file. All the unsalted hashes can be brute forced in 4 weeks, while properly salted hashes would have taken over 3000 years.
					</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>				
					<p><b>OWASP</b>
					</p><p>For a more complete set of requirements and problems to avoid in this area, see the <a id="hyperlink" href="javascript:loadURL('https://www.owasp.orghttp://www.owasp.org/index.php/ASVS#tab=Downloads');">ASVS requirements on Cryptography (V7)</a>.
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Top_10_2007-Insecure_Cryptographic_Storage');" title="Top 10 2007-Insecure Cryptographic Storage"> OWASP Top 10-2007 on Insecure Cryptographic Storage</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.orghttp://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/Encryptor.html');">ESAPI Encryptor API</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.orghttp://www.owasp.org/index.php/Guide_to_Cryptography#Insecure_transmission_of_secrets');">OWASP Development Guide: Chapter on Cryptography</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Codereview-Cryptography');" title="Codereview-Cryptography"> OWASP Code Review Guide: Chapter on Cryptography</a>
					</li>
					</ul>
					<p><b>External</b>
					</p>
					<ul>
					<li> <a id="hyperlink"  href="javascript:loadURL('https://www.owasp.orghttp://cwe.mitre.org/data/definitions/310.html');">CWE Entry 310 on Cryptographic Issues</a>
					</li>
					<li> <a id="hyperlink"  href="javascript:loadURL('http://cwe.mitre.org/data/definitions/312.html');">CWE Entry 312 on Cleartext Storage of Sensitive Information</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/326.html');">CWE Entry 326 on Weak Encryption</a>
					</li>
					</ul>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


