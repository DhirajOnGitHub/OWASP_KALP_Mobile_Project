<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">M6: Broken Cryptography</p>   
		</div>
		<div class="">
               <a class="checkbox checkbox-one" style="float:right;" onclick="toggleall();">Expand/Collapse</a>               
            </div>
       		<table class="table" id="desc-table">
			  <tbody>
				<tr onClick="toggle();"><th colspan="2" id="desc-table-header" ><a href="#" class="desc-table-header">Threat Agents</a></th></tr>
				<tr id="hidethis1"><th colspan="2" class="table-title-grey">Application Specific</th></tr>
				<tr id="hidethis11">
				<td colspan="2">
						Threat agents include the following: anyone with physical access to data that has been encrypted improperly, or mobile malware acting on an adversary's behalf.
				</td></tr>
				
				<tr onClick="toggle2();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Attack Vectors</a></th></tr>
				<tr id="hidethis2"><th colspan="2" class="table-title-red">Exploitability EASY</th></tr>
				<tr id="hidethis22">
				<td colspan="2">
						Attack vectors include the following: decryption of data via physical access to the device or network traffic capture, or malicious apps on the device with access to the encrypted data.
				</td></tr>
				
				<tr onClick="toggle3();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Security Weakness</a></th></tr>
				<tr id="hidethis3">
					<th class="table-title-orange">Prevalence COMMON</th><th class="table-title-orange">Detectability EASY</th>
				</tr>
				<tr id="hidethis33">
				<td colspan="2">
						In order to exploit this weakness, an adversary must successfully return encrypted code or sensitive data to its original unencrypted form due to weak encryption algorithms or flaws within the encryption processs.
				</td></tr>
				
				<tr onClick="toggle4();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Technical Impacts</a></th></tr>
				<tr id="hidethis4"><th colspan="2" class="table-title-red">Impact SEVERE</th></tr>
				<tr id="hidethis44">
				<td colspan="2">
						This vulnerability will result in the unauthorized retrieval of sensitive information from the mobile device.
				</td></tr>
				
				<tr onClick="toggle5();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Business Impacts</a></th></tr>
				<tr id="hidethis5"><th colspan="2" class="table-title-grey">Application / Business Specific</th></tr>
				<tr id="hidethis55"><td colspan="2">
						This vulnerability can have a number of different business impacts. Typically, broken cryptography will result in the following:
				<ul>
				<li> Privacy Violations;
				</li>
				<li> Information Theft;
				</li>
				<li> Code Theft; 
				</li>
				<li> Intellectual Property Theft; or 
				</li>
				<li> Reputational Damage.
				</li>
				</ul>
			    </td></tr>
			  </tbody>
			</table>
			
				<div class="static-notification-blue">
					<p class="center-text uppercase">Am I Vulnerable to Broken Cryptography?</p>   
				</div>					
					<p>Insecure use of cryptography is common in most mobile apps that leverage encryption. There are two fundamental ways that broken cryptography is manifested within mobile apps. First, the mobile app may use a process behind the encryption / decryption that is fundamentally flawed and can be exploited by the adversary to decrypt sensitive data. Second, the mobile app may implement or leverage an encryption / decryption algorithm that is weak in nature and can be directly decrypted by the adversary. The following subsections explore both of these scenarios in more depth:
					</p>
					
					<ul>
					<li>1 Reliance Upon Built-In Code Encryption Processes</li>
					<li>2 Poor Key Management Processes</li>
					<li>3 Creation and Use of Custom Encryption Protocols</li>
					<li>4 Use of Insecure and/or Deprecated Algorithms</li>
					</ul>
				<div class="decoration"></div>
					
					<h6>
						<span id="Reliance_Upon_Built-In_Code_Encryption_Processes">Reliance Upon Built-In Code Encryption Processes</span>
						</h6>
					<p>By default, iOS applications are protected (in theory) from reverse engineering via code encryption. The iOS security model requires that apps be encrypted and signed by trustworthy sources in order to execute in non-jailbroken environments. Upon startup, the iOS app loader will decrypt the app in memory and proceed to execute the code after its signature has been verified by iOS. This feature, in theory, prevents an attacker from conducting binary attacks againts an iOS mobile app.
					</p><p>Using freely available tools like ClutchMod or GBD, an adversary will download the encrypted app onto their jailbroken device and take a snapshot of the decrypted app once the iOS loader loads it into memory and decrypts it (just before the loader kicks off execution). Once the adversary takes the snapshot and stores it on disk, the adversary can use tools like IDA Pro or Hopper to easily perform static / dynamic analysis of the app and conduct further binary attacks.
					</p><p>Bypassing built-in code encryption algorithms is trivial at best. Always assume that an adversary will be able to bypass any built-in code encryption offered by the underlying mobile OS.
					For more information about additional steps you can take to provide additional layers of reverse engineering prevention, see M10.
					</p>
					<h6><span  id="Poor_Key_Management_Processes">Poor Key Management Processes</span></h6>
					<p>The best algorithms don't matter if you mishandle your keys. Many make the mistake of using the correct encryption algorithm, but implementing their own protocol for employing it. Some examples of problems here include:
					</p>
					<ul>
					<li> Including the keys in the same attacker-readable directory as the encrypted content;
					</li>
					<li> Making the keys otherwise available to the attacker;
					</li>
					<li> Avoid the use of hardcoded keys within your binary; and
					</li>
					<li> Keys may be intercepted via binary attacks. See M10 for more information on preventing binary attacks.
					</li>
					</ul>
					<h6><span id="Creation_and_Use_of_Custom_Encryption_Protocols">Creation and Use of Custom Encryption Protocols</span></h6>
					<p>There is no easier way to mishandle encryption--mobile or otherwise--than to try to create and use your own encryption algorithms or protocols.
					</p><p>Always use modern algorithms that are accepted as strong by the security community, and whenever possible leverage the state of the art encryption APIs within your mobile platform. Binary attacks may result in adversary identifying the common libraries you have used along with any hardcoded keys in the binary. In cases of very high security requirements around encryption, you should strongly consider the use of whitebox cryptography. See M10 for more information on preventing binary attacks that could lead to the exploitation of common libraries.
					</p>
					<h6><span id="Use_of_Insecure_and.2For_Deprecated_Algorithms">Use of Insecure and/or Deprecated Algorithms</span></h6>
					<p>Many cryptographic algorithms and protocols should not be used because they have been shown to have significant weaknesses or are otherwise insufficient for modern security requirements. These include:
					</p>
					<ul>
					<li> RC2
					</li>
					<li> MD4
					</li>
					<li> MD5
					</li>
					<li> SHA1
					</li>
					</ul>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>				
					<p>References</p>
				
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


