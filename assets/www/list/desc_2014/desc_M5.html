<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">M4: Unintended Data Leakage</p>   
		</div>
		<div class="">
               <a class="checkbox checkbox-one" style="float:right;" onclick="toggleall();">Expand/Collapse</a>               
            </div>
       		<table class="table" id="desc-table">
			  <tbody>
				<tr onClick="toggle();"><th colspan="2" id="desc-table-header" ><a href="#" class="desc-table-header">Threat Agents</a></th></tr>
				<tr id="hidethis1"><th colspan="2" class="table-title-grey">Application Specific</th></tr>
				<tr id="hidethis11">
				<td colspan="2">
						Threat agents that expolit authentication vulnerabilities typically do so through automated attacks that use available or custom-built tools. Threat agents that exploit authorization vulnerabilities typically do so through automated attacks that use available or custom-built tools.
				</td></tr>
				
				<tr onClick="toggle2();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Attack Vectors</a></th></tr>
				<tr id="hidethis2"><th colspan="2" class="table-title-red">Exploitability EASY</th></tr>
				<tr id="hidethis22">
				<td colspan="2">
						Once the adversary understands how the authentication scheme is vulnerable, they fake or bypass authentication by submitting service requests to the mobile app's backend server and bypass any direct interaction with the moblie app. This submission process is typically done via mobile malware within the device or botnets owned by the attacker. Once the adversary understands how the authorization scheme is vulnerable, they fake or bypass authorization by submitting service requests to the mobile app's backend server using a session that belongs to a user with less perission than they should have to conduct the operation. This submission process is typically done via mobile malware within the device or botnets owned by the attacker.
				</td></tr>
				
				<tr onClick="toggle3();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Security Weakness</a></th></tr>
				<tr id="hidethis3">
					<th class="table-title-orange">Prevalence COMMON</th><th class="table-title-orange">Detectability EASY</th>
				</tr>
				<tr id="hidethis33">
				<td colspan="2">
								Poor or missing authentication schemes allow an adversary to anonymously execute functionality within the mobile app or backend server used by the mobile app. Weaker authentication for mobile apps is fairly prevalent due to a mobile device's input form factor. The form factor highly encourages short passwords that are often purely based on 4-digit PINs.
						<p>Authentication requirements for mobile apps can be quite different to traiditonal web authentication schemes due to availability requirements.
						</p><p>In traditional web apps, users are exepcted to be online and authenticate in realtime with a backend server. Throughout their session, there is a reasonable expectation that they will have continuous access to the Internet.
						</p><p>In mobile apps, users are not exepcted to be online at all times during their session. Mobile internet connections are much less reliable or predictable than traiditonal web connections. Hence, mobile apps may have uptime requirements that require offline authenitcation. This offline requirement can have profound ramifications on things that developers must consider when implementing mobile authentication.
						</p><p>To detect poor authentication schemes, testers can perform binary attacks against the mobile app whilt it is in 'offline' mode. Through the attack, the tester will force the app to bypass offline authentication and then execute functionality that should require offline authentication (for more information on binary attacks, see M10). As well, testers should try to execute any backend server functionality anonymously by removing any session tokens from any POST/GET reqeusts for the mobile app functionality.
						</p>To test for poor authorization schemes, testers can perform binary attacks against the mobile app and try to execute privileged functionality that should only be executable with a user of higher privilege while the mobile app is in 'offline' mode (for more information on binary attacks, see M10). As well, testers should try to execute any privileged functionality using a low-privilege session token within the corresponding POST/GET reqeusts for the sensitive functionality to the backend server.Poor or missing authorization schemes allow an adversary to execute functionality they should not be entitled to using an authenticated but lower- privilege user of the mobile app. Authorization requirements are more vulnerable when making authorization decisions within the mobile device instead of through a remote server. This may be a requirement due to mobile requirements of offline usability.
				</td></tr>
				
				<tr onClick="toggle4();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Technical Impacts</a></th></tr>
				<tr id="hidethis4"><th colspan="2" class="table-title-red">Impact SEVERE</th></tr>
				<tr id="hidethis44">
				<td colspan="2">
				<p>The technical impact of poor authentication is that the solution is unable to identify the user performing an action requrest. Immediately, the solution will be unable to log or audit user activity because the identity of the user cannot be established. This will contribute to an inability to detect the source of an attack, the nature of any underlying exploits, or how to prevent future attacks.</p>
				<p>Authentication failures may expose underlying authorization failures as well. When authentication controls fail, the solution is unable to verify the user's identity. This identity is linked to a user's role and associated permissions. If an attacker is able to anonymously execute sensitive functionality, it highights that the underlying code is not verifying the permissions of the user issuing the request for the action. Hence, anonymous execution of code highlights failures in both authentication and authorization controls.
				</p>
				<p>The technical impact of poor authorization is similar in nature to the technical impact of poor authentication. The technical impact can be wide ranging in nature and dependent upon the nature of the over-privileged functionality that is executed. For example, over-privileged execution of remote or local administration functionality may result in destruction of systems or access to sensitive information.</p>
				</td></tr>
				
				<tr onClick="toggle5();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Business Impacts</a></th></tr>
				<tr id="hidethis5"><th colspan="2" class="table-title-grey">Application / Business Specific</th></tr>
				<tr id="hidethis55"><td colspan="2">
						<p>The business impact of poor authentication will typically result in the following at a minimum:</p>
					<ul>
					<li> Reputational Damage
					</li>
					</ul>
					<p>In the event that a user (anonymous or verified) is able to execute over-privileged functionality, the business may experience the following impacts:
					</p>
					<ul>
					<li> Reputational Damage;
					</li>
					<li> Fraud; or 
					</li>
					<li> Information Theft.
					</li>
					</ul>
			    </td></tr>
			  </tbody>
			</table>
			
				<div class="static-notification-blue">
					<p class="center-text uppercase">Am I Vulnerable To Poor Authorization and Authentication?</p>   
				</div>				
					<p>Avoid the following Insecure Mobile Application Authentication Design Patterns:
					</p>
					<ul>
					<li> If you are porting a web application to its mobile equivalent, authentication requirements of mobile applications should match that of the web application component. Therefore, it should not be possible to authenticate with less authentication factors than the web browser.
					</li>
					<li> Authenticating a user locally can lead to client-side bypass vulnerabilities. If the application stores data locally, the authentication routine can be bypassed on jailbroken devices through runtime manipulation or modification of the binary.  If there is a compelling business requirement for offline authentication, see M10 for additional guidance on preventing binary attacks against the mobile app.
					</li>
					<li> Where possible, ensure that all authentication requests are performed server-side. Upon successful authentication, application data will be loaded onto the mobile device. This will ensure that application data will only be available after successful authentication.
					</li>
					<li> If client-side storage of data is required, the data will need to be encrypted using an encryption key that is securely derived from the user’s login credentials. This will ensure that the stored application data will only be accessible upon successfully entering the correct credentials.  There are additional risks that the data will be decrypted via binary attacks. See M10 for additional guidance on preventing binary attacks that lead to local data theft.
					</li>
					<li> Persistent authentication (Remember Me) functionality implemented within mobile applications should never store a user’s password on the device.
					</li>
					<li> Ideally, mobile applications should utilize a device-specific authentication token that can be revoked within the mobile application by the user. This will ensure that the app can mitigate unauthorized access from a stolen/lost device.
					</li>
					<li> Do not use any spoof-able values for authenticating a user. This includes device identifiers or geo-location.
					</li>
					<li> Persistent authentication within mobile applications should be implemented as opt-in and not be enabled by default.
					</li>
					<li> If possible, do not allow users to provide 4-digit PIN numbers for authentication passwords.
					</li>
					</ul>
				<div class="decoration"></div>
					
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">How Do I Prevent Poor Authorization and Authentication?</p>   
				</div>								
				<p>Developers should assume all client-side authorization and authentication controls can be bypassed by malicious users. Authorization and authentication controls must be re-enforced on the server-side whenever possible.
				</p><p>Due to offline usage requirements, mobile apps may be required to perform local authentication or authorization checks within the mobile app's code. If this is the case, developers should instrument local integrity checks within their code to detect any unauthorized code changes. See M10 for more information about detecting and reacting to binary attacks.
				</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Example Scenarios</p>   
				</div>					
					<p>The following scenarios showcase weak authentication or authorization controls in mobile apps:
					</p>
					<ol>
					<li> Developers assume that only authenticated users will be able to generate a service request that the mobile app submits to its backend for processing. During the processing of the request, the server code does not verify that the incoming request is associated with a known user. Hence, adversaries submit service requests to the back-end service and anonymously execute functionality that affects legitimate users of the solution.
					</li>
					<li> Developers assume that only authorized users will be able to see the existance of a particular function on their mobile app. Hence, they expect that only legitimately authorized users will be able to issue the request for the service from their mobile device. Backend code that processes the request does not bother to verify that the identity associated with the request is entitled to execute the service. Hence, adversaries are able to perform remote administrative functionality using fairly low-privilege user accounts.
					</li>
					<li> Due to usabiltiy requirements, mobile apps allow for passwords that are 4 digits long. Server code correctly stores a hashed version of the password. However, due to the severely short length of the password, an adversary will be able to quickly deduce the original passwords using rainbow hash tables. If the password file (or data store) on the server is compromised, an adversary wil be able to quickly deduce users' passwords.
					</li>
					</ol>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>				
					<p>References</p>
				
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


