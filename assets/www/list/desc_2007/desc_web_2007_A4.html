<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A4: Insecure Direct Object Reference</p>   
		</div>
			<p>A direct object reference occurs when a developer exposes a reference to an internal implementation object, such as a file, directory, database record, or key, as a URL or form parameter. An attacker can manipulate direct object references to access other objects without authorization, unless an access control check is in place.
			</p><p>For example, in Internet Banking applications, it is common to use the account number as the primary key. Therefore, it is tempting to use the account number directly in the web interface. Even if the developers have used parameterized SQL queries to prevent SQL injection, if there is no extra check that the user is the account holder and authorized to see the account, an attacker tampering with the account number parameter can see or change <i><b>all </b></i>accounts. 
			</p><p>This type of attack occurred to the Australian Taxation Office’s <i>GST Start Up Assistance</i> site in 2000, where a legitimate but hostile user simply changed the ABN (a company tax id) present in the URL. The user farmed around 17,000 company details from the system, and then e-mailed each system. This was a major embarrassment to the Government of the 17,000 companies with details of his attack. This type of vulnerability is very common, but is largely untested in current applications.
			</p>
		<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
				All web application frameworks are vulnerable to attacks on insecure direct object references.
				<div class="decoration"></div>
		
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
				</div>	
				
					<p>Many applications expose their internal object references to users. Attackers use parameter tampering to change references and violate the intended but unenforced access control policy. Frequently, these references point to file systems and databases, but any exposed application construct could be vulnerable.
					</p><p>For example, if code allows user input to specify filenames or paths, it may allow attackers to jump out of the application’s directory, and access other resources.
					</p>
					<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
					<code>&lt;select name="language"&gt;&lt;option value="fr"&gt;Français&lt;/option&gt;&lt;/select&gt;</code>
					<code>… </code>
					<code>require_once ($_REQUEST['language’]."lang.php");</code>
					</div>
					<p>Such code can be attacked using a string like "../../../../etc/passwd%00" using <a id="hyperlink" href="https://www.owasp.org/index.php/Data_Validation" title="Data Validation">null byte injection</a> (see the <a id="hyperlink" href="https://www.owasp.org/index.php/OWASP_Guide_Project" title="OWASP Guide Project">OWASP Development Guide</a> for more information) to access any file on the web server’s file system.
					</p><p>Similarly, references to database keys are frequently exposed. An attacker can attack these parameters simply by guessing or searching for another valid key. Often, these are sequential in nature. In the example below, even if an application does not present any links to unauthorized carts, and no SQL injection is possible, an attacker can still change the cartID parameter to whatever cart they want.
					</p>
					<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
					<code>int cartID = Integer.parseInt( request.getParameter( "cartID" ) );</code>
					<code>String query = "SELECT * FROM table WHERE cartID=" + cartID;</code>
					</div>
				<div class="decoration"></div>
								
				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that the application does not allow direct object references to be manipulated by an attacker.
				</p><p>Automated approaches: Vulnerability scanning tools will have difficulty identifying which parameters are susceptible to manipulation or whether the manipulation worked. Static analysis tools really cannot know which parameters must have an access control check before use.
				</p><p>Manual approaches: Code review can trace critical parameters and identify whether they are susceptible to manipulation in many cases. Penetration testing can also verify that manipulation is possible. However, both of these techniques are time-consuming and can be spotty.
				</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>The best protection is to avoid exposing direct object references to users by using an index, indirect reference map, or other indirect method that is easy to validate. If a direct object reference must be used, ensure that the user is authorized before using it. 
					</p><p>Establishing a standard way of referring to application objects is important:
					</p>
					<ul>
					<li><b>Avoid exposing your private object references to users</b> whenever possible, such as primary keys or filenames
					</li>
					<li><b>Validate any private object references</b> extensively with an "accept known good" approach
					</li>
					<li><b>Verify authorization to all referenced objects</b>
					</li>
					</ul>
					<p>The best solution is to use an index value or a reference map to prevent parameter manipulation attacks.
					</p>
					<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;"><code><a id="hyperlink" href="http://www.example.com/application?file=1">http://www.example.com/application?file=1</a></code>
					</div>
					<p>If you must expose direct references to database structures, ensure that SQL statements and other database access methods only allow authorized records to be shown:
					</p>
					<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
					<code>int cartID = Integer.parseInt( request.getParameter( "cartID" ) );</code>
					<code>User user = (User)request.getSession().getAttribute( "user" );</code>
					<code>String query = "SELECT * FROM table WHERE 
						 cartID=" + cartID + " <b>AND userID=" + user.getID()</b>;</code>
					</div>
					<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				<ul>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0329');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0329</a>
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4369');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4369</a> 
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0229');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-0229</a>  
					</li>
					<li>GST Assist attack details, <a id="hyperlink" href="javascript:loadURL('http://www.abc.net.au/7.30/stories/s146760.htm');">http://www.abc.net.au/7.30/stories/s146760.htm</a>
					</li>
				</ul>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				<ul>
					<li>CWE: <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/639.html');">CWE-639 (Access Control Bypass Through User-Controlled Key)</a> - What OWASP refers to as an Insecure Direct Object Reference.
					</li>
					<li>CWE: <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/22.html');">CWE-22 (Path Traversal)</a> - An example of a direct object reference is a filename parameter, which the user could manipulate to access unauthorized files, even in completely different directories.
					</li>
					<li>WASC Threat Classification: <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/abuse_of_functionality.shtml');">http://www.webappsec.org/projects/threat/classes/abuse_of_functionality.shtml</a>, <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/insufficient_authorization.shtml');">http://www.webappsec.org/projects/threat/classes/insufficient_authorization.shtml</a>
					</li>
					<li>OWASP Testing Guide, <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_Path_Traversal_(OWASP-AZ-001)');" title="Testing for Path Traversal (OWASP-AZ-001)">Testing for Path Traversal</a>
					</li>
					<li>OWASP <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Category:Access_Control_Vulnerability');" title="Category:Access Control Vulnerability">Access Control Vulnerability</a>
					</li>
				</ul>
				<div class="decoration"></div>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


