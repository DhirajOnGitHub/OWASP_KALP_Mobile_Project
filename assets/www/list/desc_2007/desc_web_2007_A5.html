<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A5: Cross Site Request Forgery</p>   
		</div>
			<p>Cross site request forgery is not a new attack, but is simple and devastating. A CSRF attack forces a logged-on victim’s browser to send a request to a vulnerable web application, which then performs the chosen action on behalf of the victim. The malicious code is often not on the attacked site. This is why it is called "Cross Site".
			</p><p>This vulnerability is extremely widespread, as any web application that 
			</p>
			<ul>
			<li>Has no authorization checks for vulnerable actions
			</li>
			<li>Will process an action if a default login is able to be given in the request (e.g. http://www.example.com/admin/doSomething.ctl?username=admin&amp;passwd=admin)
			</li>
			<li>Authorizes requests based only on credentials that are automatically submitted such as the session cookie if currently logged into the application,  or “Remember me” functionality if not logged into the application, or a Kerberos token if part of an Intranet participating in integrated logon with Active Directory is at risk. Unfortunately, today, most web applications rely solely on automatically submitted credentials such as session cookies, basic authentication credentials, source IP addresses, SSL certificates, or Windows domain credentials.
			</li>
			</ul>
			<p>This vulnerability is also known by several other names including Session Riding, One-Click Attacks, Cross Site Reference Forgery, Hostile Linking, and Automation Attack. The acronym XSRF is also frequently used. OWASP and MITRE have both standardized on the term Cross Site Request Forgery and CSRF.
			</p>
		<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
				<p>All web application frameworks are vulnerable to CSRF.
</p>

				<div class="decoration"></div>
		
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
				</div>	
				<p>A typical CSRF attack against a forum might take the form of directing the user to invoke some function, such as the application’s logout page. The following tag in any web page viewed by the victim will generate a request which logs them out:
				</p>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
				<code>&lt;img src="http://www.example.com/logout.php&quot;&gt;</code>
				</div>
				<p>If an online bank allowed its application to process requests, such as transfer funds, a similar attack might allow:
				</p>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
				<code>&lt;img src=&quot;http://www.example.com/transfer.do?frmAcct=document.form.frmAcct&amp;<br>
					 toAcct=4345754&amp;toSWIFTid=434343&amp;amt=3434.43&quot;&gt;</code>
				</div>
				<p>Jeremiah Grossman in his BlackHat 2006 talk <a id="hyperlink" href="javascript:loadURL('http://www.whitehatsec.com/presentations/whitehat_bh_pres_08032006.tar.gz');">Hacking Intranet Sites from the outside</a>, demonstrated that it is possible to force a user to make changes to their DSL router without their consent; even if the user does not know that the DSL router has a web interface. Jeremiah used the router’s default account name to perform the attack. 
				</p><p>All of these attacks work because the user’s authorization credential (typically the session cookie) is automatically included with such requests by the browser, even though the attacker didn’t supply that credential.
				</p><p>If the tag containing the attack can be posted to a vulnerable application, then the likelihood of finding logged in victims is significantly increased, similar to the increase in risk between stored and reflected XSS flaws. XSS flaws are not required for a CSRF attack to work, although any application with XSS flaws is susceptible to CSRF because a CSRF attack can exploit the XSS flaw to steal any non-automatically submitted credential that might be in place to protect against a CSRF attack. Many application worms have used both techniques in combination.
				</p><p>When building defenses against CSRF attacks, you must also focus on eliminating XSS vulnerabilities in your application since such flaws can be used to get around most CSRF defenses you might put in place.
				</p>
				<div class="decoration"></div>
								
				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that the application protects against CSRF attacks by generating and then requiring some type of authorization token that is not automatically submitted by the browser. 
				</p>
				<p>Automated approaches: Few automated Automated scanners can detect CSRF vulnerabilities today, even though CSRF detection can be somewhat automated given a sufficiently capable application scanning engines.engine. However, if your application scanner picks up a cross-site scripting vulnerability and you have no anti-CSRF protections, you are very likely to be at risk from pre-canned CSRF attacks.
				</p>
				<p>Manual approaches: Penetration testing is a quick way to verify that CSRF protection is in place. To verify that the mechanism is strong and properly implemented, checking the code is the most efficient course of action.
				</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>Applications must ensure that they are not relying on credentials or tokens that are automatically submitted by browsers. The only solution is to use a custom token that the browser will not ‘remember’ and then automatically include with a CSRF attack.
				</p><p>The following strategies should be inherent in all web applications: 
				</p>
				<ul>
				<li><b>Ensure that there are no XSS vulnerabilities in your application</b> (see A1 – Cross Site Scripting)
				</li>
				<li><b>Insert custom random tokens into every form and URL</b> that will not be automatically submitted by the browser. For example,
				</li>
				</ul>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
				<code>&lt;form action="/transfer.do" method="post"&gt;</code>
				<code>&lt;input type="hidden" name="8438927730" value="43847384383"&gt;</code>
				<code>…</code>
				<code>&lt;/form&gt;</code>
				</div>
				<p>and then verify that the submitted token is correct for the current user. Such tokens can be unique to that particular function or page for that user, or simply unique to the overall session. The more focused the token is to a particular function and/or particular set of data, the stronger the protection will be, but the more complicated it will be to construct and maintain
				</p>
				<ul>
				<li><b>For sensitive data or value transactions, re-authenticate or use transaction signing</b> to ensure that the request is genuine. Set up external mechanisms such as e-mail or phone contact in order to verify requests or notify the user of the request.
				</li>
				<li><b>Do not use GET requests (URLs) for sensitive data or to perform value transactions.</b> Use only POST methods when processing sensitive data from the user. However, the URL may contain the random token as this creates a unique URL, which makes CSRF almost impossible to perform. 
				</li>
				<li><b>POST alone is insufficient a protection. </b>You must also combine it with random tokens, out of band authentication or re-authentication to properly protect against CSRF
				</li>
				<li>For ASP.NET,<b> </b><a id="hyperlink" href="javascript:loadURL('http://msdn2.microsoft.com/en-us/library/ms972969.aspx');">set a ViewStateUserKey</a><b>. </b>(See references). This provides a similar type of check to a random token as described above.
				</li>
				</ul>
				<p>While these suggestions will diminish your exposure dramatically, advanced CSRF attacks can bypass many of these restrictions. The strongest technique is the use of unique tokens, and eliminating all XSS vulnerabilities in your application.
				</p>
					<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				<ul>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0192');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0192</a>
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5116');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5116</a>
					</li>
					<li>MySpace Samy Interview <a id="hyperlink" href="javascript:loadURL('http://blog.outer-court.com/archive/2005-10-14-n81.html');">http://blog.outer-court.com/archive/2005-10-14-n81.html</a>
					</li>
					<li>An attack which uses Quicktime to perform CSRF attacks
					<ul>
					<li><a id="hyperlink" href="javascript:loadURL('http://www.computerworld.com/action/article.do?command=viewArticleBasic&amp;articleId=9005607&amp;intsrc=hm_list');">http://www.computerworld.com/action/article.do?command=viewArticleBasic&amp;articleId=9005607&amp;intsrc=hm_list</a> 
					</li>
					</ul>
					</li>
				</ul>
				<div class="decoration"></div>				
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Related Articles</p>   
				</div>
				<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Cross-Site_Request_Forgery')" title="Cross-Site Request Forgery">Cross-Site Request Forgery</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_CSRF_(OWASP-SM-005)');" title="Testing for CSRF (OWASP-SM-005)">Testing for CSRF</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/CSRF_Guard');" title="CSRF Guard" class="mw-redirect">CSRF Guard</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/PHP_CSRF_Guard');" title="PHP CSRF Guard">PHP CSRF Guard</a>
					</li>
				</ul>
				
				<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				<ul>
					<li>CWE: CWE-352 (Cross-Site Request Forgery)
					</li>
					<li>WASC Threat Classification: No direct mapping, but the following is a close match:
					<ul>
					<li><a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/abuse_of_functionality.shtml');">http://www.webappsec.org/projects/threat/classes/abuse_of_functionality.shtml</a> 
					</li>
					</ul>
					</li>
					<li>RSnake, "What is CSRF?", <a id="hyperlink" href="javascript:loadURL('http://ha.ckers.org/blog/20061030/what-is-csrf/');">http://ha.ckers.org/blog/20061030/what-is-csrf/</a>
					</li>
				</ul>
				<div class="decoration"></div>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


