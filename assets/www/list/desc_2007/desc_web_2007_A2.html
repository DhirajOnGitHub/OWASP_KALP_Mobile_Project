<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A2: Injection Flaws</p>   
		</div>
		    		
			<p>
			Injection flaws, particularly SQL injection, are unfortunately very common in web applications. There are many types of injections: <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/89.html');">SQL</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/564.html');">Hibernate Query Language (HQL)</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/90.html');">LDAP</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/91.html');">XPath</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/652.html');">XQuery</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/91.html');">XSLT</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/91.html');">XML</a>, <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/78.html');">OS command injection</a> and many more.
</p>
<p>
			Injection occurs when user-supplied data is sent to an interpreter as part of a command or query. Attackers trick the interpreter into executing unintended commands via supplying specially crafted data. Injection flaws allow attackers to create, read, update, or delete any arbitrary data available to the application. In the worst case scenario, these flaws allow an attacker to completely compromise the application and the underlying systems, even bypassing deeply nested firewalled environments.
			</p>
			<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
					
					<p>All web application frameworks that use interpreters or invoke other processes are vulnerable to injection attacks. This includes any components of the framework, that might use back-end interpreters.</p>
					
				<div class="decoration"></div>				
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
					</div>
					
				<p>If user input is passed into an interpreter without validation or encoding, the application is vulnerable. Check if user input is supplied to dynamic queries, such as:
				</p>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;"><i>PHP:</i>
				   $sql = "SELECT * FROM table WHERE id = '" . $_REQUEST['id'] . "'"; 
				</div><br>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;"><i>Java:</i>
				   String query = "SELECT user_id FROM user_data WHERE 
						user_name = '" + req.getParameter("userID") + "' and 
						user_password = '" + req.getParameter("pwd") +"'";
				</div>
				<div class="decoration"></div>
								
				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that all the parameters in the application are validated and/or encoded before being included in HTML pages.
				</p><p><b>Automated approaches: </b>Automated penetration testing tools are capable of detecting reflected XSS via parameter injection, but often fail to find persistent XSS, particularly if the output of the injected XSS vector is prevented via authorization checks (such as if a user inputs hostile data which only admins can see sometime later). Automated source code scanning tools can find weak or dangerous APIs but usually cannot determine if validation or encoding has taken place, which may result in false positives. Neither tool type is able to find DOM based XSS, which means that Ajax based applications will usually be at risk if only automated testing takes place.
				</p><p><b>Manual approaches: </b>If a centralized validation and encoding mechanism is used, the most efficient way to verify security is to check the code. If a distributed implementation is used, then the verification will be considerably more time-consuming. Testing is time-consuming because the attack surface of most applications is so large.
				</p>

				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>Avoid the use of interpreters when possible. If you must invoke an interpreter, the key method to avoid injections is the use of safe APIs, such as strongly typed parameterized queries and object relational mapping (ORM) libraries that are immune to injection (be careful here - Hibernate, for example is NOT immune to injection by itself. You have to use named parameters to be safe in Hibernate). These interfaces handle all data escaping, or do not require escaping. Note that while safe interfaces solve the problem, validation is still recommended in order to detect attacks.
					</p><p>Using interpreters is dangerous, so it's worth it to take extra care, such as the following:
					</p>
					<ul>
					<li><b>Input validation.</b> Use a standard input validation mechanism to validate all input data for length, type, syntax, and business rules before accepting the data to be displayed or stored. Use an "accept known good" validation strategy. Reject invalid input rather than attempting to sanitize potentially hostile data. Do not forget that error messages might also include invalid data
					</li>
					<li><b>Use strongly typed parameterized query APIs</b> with placeholder substitution markers, even when calling stored procedures
					</li>
					<li><b>Enforce least privilege</b> when connecting to databases and other backend systems
					</li>
					<li><b>Avoid detailed error messages</b> that are useful to an attacker
					</li>
					<li><b>Show care when using stored procedures</b> since they are generally safe from SQL Injection. However, be careful as they can be injectable (such as via the use of exec() or concatenating arguments within the stored procedure) 
					</li>
					<li><b>Do not use dynamic query interfaces</b> (such as mysql_query() or similar)
					</li>
					<li><b>Do not use simple escaping functions</b>, such as PHP's addslashes() or character replacement functions like str_replace("'", "<i>"). These are weak and have been successfully exploited by attackers. For PHP, use mysql_real_escape_string() if using MySQL, or preferably use PDO which does not require escaping</i>
					</li>
					<li>When using simple escape mechanisms, note that<b> simple escaping functions cannot escape table names</b>! Table names must be legal SQL, and thus are completely unsuitable for user supplied input
					</li>
					<li><b>Watch out for canonicalization errors.</b> Inputs must be decoded and canonicalized to the application's current internal representation before being validated. Make sure that your application does not decode the same input twice. Such errors could be used to bypass whitelist schemes by introducing dangerous inputs after they have been checked
					</li>
					</ul>
					<p>Language specific recommendations:
					</p>
					<ul>
					<li>Java EE - use strongly typed PreparedStatement, or ORMs such as Spring or named parameters within Hibernate.
					</li>
					<li>.NET - use strongly typed parameterized queries, such as SqlCommand with SqlParameter, or named parameters within Hibernate.
					</li>
					<li>PHP - use PDO with strongly typed parameterized queries (using bindParam()).
					</li>
					</ul>
				
					<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				
					<ul>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5121');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5121</a>    
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4953');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4953</a>  
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4592');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4592</a> 
					</li>
					</ul>
				<div class="decoration"></div>
				
								<div class="static-notification-blue">
					<p class="center-text uppercase">Related Pages</p>   
				</div>
				<ul>
				<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/SQL_Injection');" title="SQL Injection">SQL Injection</a>
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Guide_to_SQL_Injection');" title="Guide to SQL Injection">Guide to SQL Injection</a>
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet');" title="SQL Injection Prevention Cheat Sheet">SQL Injection Prevention Cheat Sheet</a>
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Reviewing_Code_for_SQL_Injection');" title="Reviewing Code for SQL Injection">Reviewing Code for SQL Injection</a>
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OWASP-DV-005)');" title="Testing for SQL Injection (OWASP-DV-005)">Testing for SQL Injection</a>
				</li>
				</ul>
				<div class="decoration"></div>
				
								<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				<ul>
					<li>CWE: CWE-89 (SQL Injection), CWE-77 (Command Injection), CWE-90 (LDAP Injection), CWE-91 (XML Injection), CWE-93 (CRLF Injection), others.
					</li>
					<li>WASC Threat Classification: <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/sql_injection.shtml');">(1) SQL Injection</a>  <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/ldap_injection.shtml');">(2) LDAP Injection</a> <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/os_commanding.shtml');">(3) OS Commanding</a>
					</li>
					<li>Advanced SQL Injection, <a id="hyperlink" href="javascript:loadURL('http://www.ngssoftware.com/papers/advanced_sql_injection.pdf');">http://www.ngssoftware.com/papers/advanced_sql_injection.pdf</a>    
					</li>
					<li>More Advanced SQL Injection, <a id="hyperlink" href="javascript:loadURL('http://www.nextgenss.com/papers/more_advanced_sql_injection.pdf');">http://www.nextgenss.com/papers/more_advanced_sql_injection.pdf</a>
					</li>
					<li>Hibernate, an advanced object relational manager (ORM) for J2EE and .NET, <a id="hyperlink" href="javascript:loadURL('http://www.hibernate.org/');">http://www.hibernate.org/</a> 
					</li>
					<li>J2EE Prepared Statements, <a id="hyperlink" href="javascript:loadURL('http://java.sun.com/docs/books/tutorial/jdbc/basics/prepared.html');">http://java.sun.com/docs/books/tutorial/jdbc/basics/prepared.html</a>
					</li>
					<li>How to: Protect from SQL injection in ASP.Net, <a id="hyperlink" href="javascript:loadURL('http://msdn2.microsoft.com/en-us/library/ms998271.aspx');">http://msdn2.microsoft.com/en-us/library/ms998271.aspx</a> 
					</li>
					<li>PHP PDO functions, <a id="hyperlink" href="javascript:loadURL('http://php.net/pdo');">http://php.net/pdo</a>
					</li>
					<li>SQL Injection, <a id="hyperlink" href="javascript:loadURL('http://packetstorm.codar.com.br/papers/general/SQLInjectionWhitePaper.pdf');">http://packetstorm.codar.com.br/papers/general/SQLInjectionWhitePaper.pdf</a> 
					</li>
				</ul>
				<div class="decoration"></div>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


