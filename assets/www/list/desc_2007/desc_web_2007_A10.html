<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A10: Failure to Restrict URL Access</p>   
		</div>
			<p>Frequently, the only protection for a URL is that links to that page are not presented to unauthorized users. However, a motivated, skilled, or just plain lucky attacker may be able to find and access these pages, invoke functions, and view data. Security by obscurity is not sufficient to protect sensitive functions and data in an application. Access control checks must be performed before a request to a sensitive function is granted, which ensures that the user is authorized to access that function.</p>
		<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
				<p>All web application frameworks are vulnerable to failure to restrict URL access.</p>
				<div class="decoration"></div>
		
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
				</div>	
					<p>The primary attack method for this vulnerability is called "forced browsing", which encompasses guessing links and brute force techniques to find unprotected pages. Applications frequently allow access control code to evolve and spread throughout a codebase, resulting in a complex model that is difficult to understand for developers and security specialists alike. This complexity makes it likely that errors will occur and pages will be missed, leaving them exposed.
					</p><p>Some common examples of these flaws include:
					</p>
					<ul>
					<li>"Hidden" or "special" URLs, rendered only to administrators or privileged users in the presentation layer, but accessible to all users if they know it exists, such as /admin/adduser.php or /approveTransfer.do. This is particularly prevalent with menu code.
					</li>
					<li>Applications often allow access to "hidden" files, such as static XML or system generated reports, trusting security through obscurity to hide them.
					</li>
					<li>Code that enforces an access control policy but is out of date or insufficient. For example, imagine /approveTransfer.do was once available to all users, but since SOX controls were brought in, it is only supposed to be available to approvers. A fix might have been to not present it to unauthorized users, but no access control is actually enforced when requesting that page.
					</li>
					<li>Code that evaluates privileges on the client but not on the server, as in this <a id="hyperlink" href="javascript:loadURL('http://grutztopia.jingojango.net/2007/01/your-free-macworld-expo-platinum-pass_11.html');">attack on MacWorld 2007</a>, which approved "Platinum" passes worth $1700 via JavaScript on the browser rather than on the server.
					</li>
					</ul>
				<div class="decoration"></div>
								
				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that access control is enforced consistently in the presentation layer and the business logic for all URLs in the application.
				</p><p>Automated approaches: Both vulnerability scanners and static analysis tools have difficulty with verifying URL access control, but for different reasons. Vulnerability scanners have difficulty guessing hidden pages and determining which pages should be allowed for each user, while static analysis engines struggle to identify custom access controls in the code and link the presentation layer with the business logic.
				</p><p>Manual approaches: The most efficient and accurate approach is to use a combination of code review and security testing to verify the access control mechanism. If the mechanism is centralized, the verification can be quite efficient. If the mechanism is distributed across an entire codebase, verification can be more time-consuming. If the mechanism is enforced externally, the configuration must be examined and tested.
				</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>Taking the time to plan authorization by creating a matrix to map the roles and functions of the application is a key step in achieving protection against unrestricted URL access. Web applications must enforce access control on every URL and business function. It is not sufficient to put access control into the presentation layer and leave the business logic unprotected. It is also not sufficient to check once during the process to ensure the user is authorized, and then not check again on subsequent steps. Otherwise, an attacker can simply skip the step where authorization is checked, and forge the parameter values necessary to continue on at the next step.
				</p><p>Enabling URL access control takes some careful planning. Among the most important considerations are:
				</p>
				<ul>
				<li><b>Ensure the access control matrix is part of the business, architecture, and design of the application</b>
				</li>
				<li><b>Ensure that all URLs and business functions are protected by an effective access control mechanism</b> that verifies the user’s role and entitlements prior to any processing taking place. Make sure this is done during every step of the way, not just once towards the beginning of any multi-step process
				</li>
				<li><b>Perform a penetration test </b>prior to deployment or code delivery to ensure that the application cannot be misused by a motivated skilled attacker
				</li>
				<li><b>Pay close attention to include/library files</b>, especially if they have an executable extension such as .php.  Where feasible, they should be kept outside of the web root.  They should verify that they are not being directly accessed, e.g. by checking for a constant that can only be created by the library’s caller
				</li>
				<li><b>Do not</b> <b>assume that users will be unaware of special or hidden URLs or APIs</b>. Always ensure that administrative and high privilege actions are protected
				</li>
				<li><b>Block access to all file types that your application should never serve</b>. Ideally, this filter would follow the "accept known good" approach and only allow file types that you intend to serve, e.g., .html, .pdf, .php. This would then block any attempts to access log files, xml files, etc. that you never intend to serve directly. 
				</li>
				<li><b>Keep up to date with virus protection and patches</b> to components such as XML processors, word processors, image processors, etc., which handle user supplied data
				</li>
				</ul>
					<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				<ul>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0682');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0682</a>
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0147');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0147</a>
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0131');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0131</a>  
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1227');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1227</a>
				</li>
				</ul>
				<div class="decoration"></div>
				
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				<ul>
				<li>CWE: CWE-425 (Direct Request), CWE-288 (Authentication Bypass by Alternate Path), CWE-285 (Missing or Inconsistent Access Control)
				</li>
				<li>WASC Threat Classification: <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/predictable_resource_location.shtml');">http://www.webappsec.org/projects/threat/classes/predictable_resource_location.shtml</a> 
				</li>
				<li>OWASP, <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Forced_browsing');" title="Forced browsing">Forced browsing</a>
				</li>
				<li>OWASP Development Guide, <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Guide_to_Authorization');" title="Guide to Authorization">Guide to Authorization</a>
				</li>
				</ul>		
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>