<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A1: Cross Site Scripting</p>   
		</div>
		    		
			<p>
			Cross-site scripting, better known as XSS, is in fact a subset of HTML injection. XSS is the most prevalent and pernicious web application security issue. XSS flaws occur whenever an application takes data that originated from a user and sends it to a web browser without first validating or encoding that content.
			</p>
			<p>
			XSS allows attackers to execute scripts in the victim’s browser, which can hijack user sessions, deface web sites, insert hostile content, conduct phishing attacks, and take over the user’s browser using scripting malware. The malicious script is usually JavaScript, but any scripting language supported by the victim’s browser is a potential target for this attack.
			</p>
			<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
					
					<p>All web application frameworks are vulnerable to cross site scripting.</p>
					
				<div class="decoration"></div>				
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
					</div>
					
				<p>There are three known types of cross site scripting: reflected, stored, and DOM injection. Reflected XSS is the easiest to exploit – a page will reflect user supplied data directly back to the user:
				</p>
				<div style="border: 2px dashed #444444; background-color: #D0D0D0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">echo $_REQUEST['userinput'];
				</div>
				<p>Stored XSS takes hostile data, stores it in a file, a database, or other back end system, and then at a later stage, displays the data to the user, unfiltered. This is extremely dangerous in systems such as CMS, blogs, or forums, where a large number of users will see input from other individuals.
				</p><p>With DOM based XSS attacks, the site’s JavaScript code and variables are manipulated rather than HTML elements.
				</p><p>Alternatively, attacks can be a blend or hybrid of all three types. The danger with cross site scripting is not the type of attack, but that it is possible. Non-standard or unexpected browser behaviors can introduce subtle attack vectors. XSS is also potentially reachable through any components that the browser uses.
				</p><p>Attacks are usually implemented in JavaScript, which is a powerful scripting language. Using JavaScript allows attackers to manipulate any aspect of the rendered page, including adding new elements (such as adding a login tile which forwards credentials to a hostile site), manipulating any aspect of the internal DOM tree, and deleting or changing the way the page looks and feels. JavaScript allows the use of XmlHttpRequest, which is typically used by sites using AJAX technologies, even if victim site does not use AJAX today. 
				</p><p>Using XmlHttpRequest, it is sometimes possible to get around a browser’s same source origination policy - thus forwarding victim data to hostile sites, and to create complex worms and malicious zombies that last as long as the browser stays open. AJAX attacks do not have to be visible or require user interaction to perform dangerous <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Top_10_2007-A5');">cross site request forgery (CSRF) attacks</a>.
				</p>
				<div class="decoration"></div>

				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that all the parameters in the application are validated and/or encoded before being included in HTML pages.
				</p><p><b>Automated approaches: </b>Automated penetration testing tools are capable of detecting reflected XSS via parameter injection, but often fail to find persistent XSS, particularly if the output of the injected XSS vector is prevented via authorization checks (such as if a user inputs hostile data which only admins can see sometime later). Automated source code scanning tools can find weak or dangerous APIs but usually cannot determine if validation or encoding has taken place, which may result in false positives. Neither tool type is able to find DOM based XSS, which means that Ajax based applications will usually be at risk if only automated testing takes place.
				</p><p><b>Manual approaches: </b>If a centralized validation and encoding mechanism is used, the most efficient way to verify security is to check the code. If a distributed implementation is used, then the verification will be considerably more time-consuming. Testing is time-consuming because the attack surface of most applications is so large.
				</p>

				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>The best protection for XSS is a combination of "whitelist" validation of all incoming data and appropriate encoding of all output data. Validation allows the detection of attacks, and encoding prevents any successful script injection from running in the browser.
				</p><p>Preventing XSS across an entire application requires a consistent architectural approach:
				</p>
				<ul>
				<li><b>Input validation.</b> Use a standard input validation mechanism to validate all input data for length, type, syntax, and business rules before accepting the data to be displayed or stored. Use an "accept known good" validation strategy. Reject invalid input rather than attempting to sanitize potentially hostile data. Do not forget that error messages might also include invalid data.
				</li>
				<li><b>Strong output encoding.</b> Ensure that all user-supplied data is appropriately entity encoded (either HTML or XML depending on the output mechanism) before rendering, taking the approach to encode all characters other than a very limited subset. This is the approach of the Microsoft Anti-XSS library, and the forthcoming OWASP PHP Anti-XSS library. Also, set the character encodings for each page you output, which will reduce exposure to some variants.
				</li>
				<li><b>Specify the output encoding </b>(such as ISO 8859-1 or UTF 8). Do not allow the attacker to choose this for your users.
				</li>
				<li><b>Do not</b> <b>use "blacklist" validation </b>to detect XSS in input or to encode output. Searching for and replacing just a few characters ("&lt;" "&gt;" and other similar characters or phrases such as “script”) is weak and has been attacked successfully. Even an unchecked “&lt;b&gt;” tag is unsafe in some contexts. XSS has a surprising number of variants that make it easy to bypass blacklist validation.
				</li>
				<li><b>Watch out for canonicalization errors.</b> Inputs must be decoded and canonicalized to the application’s current internal representation before being validated. Make sure that your application does not decode the same input twice. Such errors could be used to bypass whitelist schemes by introducing dangerous inputs after they have been checked.
				</li>
				</ul>
				<p>Language specific recommendations:
				</p>
				<ul>
				<li><b>Java: Use Struts output mechanisms such</b> as &lt;bean:write … &gt;, or use the default JSTL escapeXML="true" attribute in &lt;c:out … &gt;. Do NOT use &lt;%= …&#160;%&gt; unnested (that is, outside of a properly encoded output mechanism)
				</li>
				<li><b>.NET: Use the Microsoft Anti-XSS Library </b>1.5 freely available from MSDN. Do not assign form fields data directly from the Request object: <code>username.Text = Request.QueryString("username");</code> without using this library. Understand which .NET controls automatically encode output data
				</li>
				<li><b>PHP: Ensure output is passed through <code>htmlentities()</code> or <code>htmlspecialchars()</code></b> or use the soon to be released OWASP PHP Anti-XSS library. <b>Disable register_globals</b> if it is not already disabled
				</li>
				</ul>
				
								<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				
				<ul>
				<li><a id="hyperlink"  href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4206%20');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4206 </a>  
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3966%20');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3966 </a>  
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5204%20');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5204 </a>  
					</li>
					</ul>
				<div class="decoration"></div>
				
								<div class="static-notification-blue">
					<p class="center-text uppercase">Related Pages</p>   
				</div>
				
				<ul>
					<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Category:OWASP_Stinger_Project');" title="Category:OWASP Stinger Project">Category:OWASP Stinger Project</a>
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_Cross_site_scripting');" title="Testing for Cross site scripting">Testing for Cross site scripting</a>
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/OWASP_PHP_Filters');" title="OWASP PHP Filters">OWASP PHP Filters</a>
					</li>
					<li><a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Category:OWASP_Encoding_Project');" title="Category:OWASP Encoding Project">Category:OWASP Encoding Project</a>
					</li>
					</ul>
				<div class="decoration"></div>
				
								<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				
				<ul>
				<li>CWE: CWE-79, Cross-Site scripting (XSS)
				</li>
				<li>WASC Threat Classification: <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/cross-site_scripting.shtml');">http://www.webappsec.org/projects/threat/classes/cross-site_scripting.shtml</a>
				</li>
				<li>OWASP – <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)');" title="Cross-site Scripting (XSS)">Cross-site Scripting (XSS)</a>
				</li>
				<li>OWASP – <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_Cross_site_scripting');" title="Testing for Cross site scripting">Testing for Cross site scripting</a>
				</li>
				<li>OWASP <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Category:OWASP_Stinger_Project');" title="Category:OWASP Stinger Project">Stinger Project</a> (A Java EE validation filter) 
				</li>
				<li>OWASP <a  id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/OWASP_PHP_Filters');" title="OWASP PHP Filters">PHP Filter Project</a> 
				</li>
				<li>OWASP <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Category:OWASP_Encoding_Project');" title="Category:OWASP Encoding Project">Encoding Project</a> 
				</li>
				<li>RSnake, XSS Cheat Sheet, <a id="hyperlink" href="javascript:loadURL('http://ha.ckers.org/xss.html');">http://ha.ckers.org/xss.html </a>  
				</li>
				<li>Klein, A., DOM Based Cross Site Scripting, <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/articles/071105.shtml');">http://www.webappsec.org/projects/articles/071105.shtml </a>  
				</li>
				<li>.NET Anti-XSS Library - <a id="hyperlink" href="javascript:loadURL('http://www.microsoft.com/downloads/details.aspx?FamilyID=efb9c819-53ff-4f82-bfaf-e11625130c25&amp;DisplayLang=en');">http://www.microsoft.com/downloads/details.aspx?FamilyID=efb9c819-53ff-4f82-bfaf-e11625130c25&amp;DisplayLang=en</a> 
				</li>
				</ul>
				<div class="decoration"></div>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


