<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A8: Insecure Cryptographic Storage</p>   
		</div>
			<p>Protecting sensitive data with cryptography has become a key part of most web applications. Simply failing to encrypt sensitive data is very widespread. Applications that do encrypt frequently contain poorly designed cryptography, either using inappropriate ciphers or making serious mistakes using strong ciphers. These flaws can lead to disclosure of sensitive data and compliance violations.
			</p>
		<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
				<p>All web application frameworks are vulnerable to insecure cryptographic storage.</p>
				<div class="decoration"></div>
		
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
				</div>	
					<p>Preventing cryptographic flaws takes careful planning. The most common problems are:
					</p>
					<ul>
					<li>Not encrypting sensitive data
					</li>
					<li>Using home grown algorithms
					</li>
					<li>Insecure use of strong algorithms 
					</li>
					<li>Continued use of proven weak algorithms (MD5, SHA-1, RC3, RC4, etcâ€¦)
					</li>
					<li>Hard coding keys, and storing keys in unprotected stores
					</li>
					</ul>
				<div class="decoration"></div>
								
				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that the application properly encrypts sensitive information in storage.
				</p><p>Automated approaches: Vulnerability scanning tools cannot verify cryptographic storage at all. Code scanning tools can detect use of known cryptographic APIs, but cannot detect if it is being used properly or if the encryption is performed in an external component.
				</p><p>Manual approaches: Like scanning, testing cannot verify cryptographic storage. Code review is the best way to verify that an application encrypts sensitive data and has properly implemented the mechanism and key management. This may involve the examination of the configuration of external systems in some cases.
				</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>The most important aspect is to ensure that everything that should be encrypted is actually encrypted. Then you must ensure that the cryptography is implemented properly. As there are so many ways of using cryptography improperly, the following recommendations should be taken as part of your testing regime to help ensure secure cryptographic materials handling: 
				</p>
				<ul>
				<li><b>Do not</b> <b>create cryptographic algorithms</b>. Only use approved public algorithms such as AES, RSA public key cryptography, and SHA-256 or better for hashing. 
				</li>
				<li><b>Do not</b> <b>use weak algorithms</b>, such as MD5 / SHA1. Favor safer alternatives, such as SHA-256 or better.
				</li>
				<li><b>Generate keys offline and store private keys with extreme care. </b>Never transmit private keys over insecure channels
				</li>
				<li><b>Ensure that infrastructure credentials such as database credentials or MQ queue access details are properly secured</b> (via tight file system permissions and controls), or securely encrypted and not easily decrypted by local or remote users
				</li>
				<li><b>Ensure that encrypted data stored on disk is not easy to decrypt</b>. For example, database encryption is worthless if the database connection pool provides unencrypted access. 
				</li>
				<li>Under PCI Data Security Standard requirement 3, you must protect cardholder data. PCI DSS compliance is mandatory by 2008 for merchants and anyone else dealing with credit cards. <b>Good practice is to never store unnecessary data</b>, such as the magnetic stripe information or the primary account number (PAN, otherwise known as the credit card number). If you store the PAN, the DSS compliance requirements are significant. For example, you are NEVER allowed to store the CVV number (the three digit number on the rear of the card) under any circumstances. For more information, please see the PCI DSS Guidelines and implement controls as necessary.
				</li>
				</ul>
					<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				<ul>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6145');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6145</a> 
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1664');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-1664</a> 
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1101');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-1999-1101</a> 
				</li>
				<li> True of most Java EE servlet containers, too.
				</li>
				</ul>
				<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Related Articles</p>   
				</div>
				<ul>
				<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Guide_to_Cryptography');" title="Guide to Cryptography">Guide to Cryptography</a>
				</li>
				<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Insecure_Storage');" title="Insecure Storage">Insecure Storage</a>
				</li>
				<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/How_to_protect_sensitive_data_in_URL%27s');" title="How to protect sensitive data in URL's">How to protect sensitive data in URL's</a>
				</li>
				</ul>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				<ul>
				<li>CWE: CWE-311 (Failure to encrypt data), CWE-326 (Weak Encryption), CWE-321 (Use of hard-coded cryptographic key), CWE-325 (Missing Required Cryptographic Step), others.
				</li>
				<li>WASC Threat Classification: No explicit mapping 
				</li>
				<li>PCI Data Security Standard v1.1,  <a id="hyperlink" href="javascript:loadURL('https://www.pcisecuritystandards.org/pdfs/pci_dss_v1-1.pdf');">https://www.pcisecuritystandards.org/pdfs/pci_dss_v1-1.pdf</a> 
				</li>
				<li>Bruce Schneier, <a id="hyperlink" href="javascript:loadURL('http://www.schneier.com/');">http://www.schneier.com/</a> 
				</li>
				<li>CryptoAPI Next Generation, <a id="hyperlink" href="javascript:loadURL('http://msdn2.microsoft.com/en-us/library/aa376210.aspx');">http://msdn2.microsoft.com/en-us/library/aa376210.aspx</a> 
				</li>
				</ul>
				
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>