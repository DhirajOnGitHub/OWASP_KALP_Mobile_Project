<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A7: Broken Authentication and Session Management</p>   
		</div>
			<p>
			Proper authentication and session management is critical to web application security. Flaws in this area most frequently involve the failure to protect credentials and session tokens through their lifecycle. These flaws can lead to the hijacking of user or administrative accounts, undermine authorization and accountability controls, and cause privacy violations.
			</p>
		<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Environments Affected</p>   
				</div>				
				<p>All web application frameworks are vulnerable to authentication and session management flaws.</p>
				<div class="decoration"></div>
		
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Vulnerability</p>   
				</div>	
					<p>Flaws in the main authentication mechanism are not uncommon, but weaknesses are more often introduced through ancillary authentication functions such as logout, password management, timeout, remember me, secret question, and account update.
					</p>
				<div class="decoration"></div>
								
				<div class="static-notification-blue">
					<p class="center-text uppercase">Verifying Security</p>   
				</div>	
				<p>The goal is to verify that the application properly authenticates users and properly protects identities and their associated credentials.
				</p><p>Automated approaches: Vulnerability scanning tools have a very difficult time detecting vulnerabilities in custom authentication and session management schemes. Static analysis tools are also not likely to detect authentication and session management problems in custom code.
				</p><p>Manual approaches: Code review and testing, especially in combination, are quite effective at verifying that the authentication, session management, and ancillary functions are all implemented properly.
				</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Protection</p>   
				</div>				
				<p>Authentication relies on secure communication and credential storage. First ensure that SSL is the only option for all authenticated parts of the application (see A9 Ã¢ÂÂ Insecure Communications) and that all credentials are stored in hashed or encrypted form (see A8 Ã¢ÂÂ Insecure Cryptographic Storage).
				</p><p>Preventing authentication flaws takes careful planning. Among the most important considerations are: 
				</p>
				<ul>
				<li><b>Only use the inbuilt session management mechanism.</b> Do not write or use secondary session handlers under any circumstances.
				</li>
				<li><b>Do not accept new, preset or invalid session identifiers</b> from the URL or in the request. This is called a session fixation attack.
				</li>
				<li><b>Limit or rid your code of custom cookies for authentication or session management </b>purposes, such as "remember me" type functionality or home grown single-sign on functionality. This does not apply to robust, well proven SSO or federated authentication solutions.
				</li>
				<li><b>Use a single authentication mechanism</b> with appropriate strength and number of factors.  Make sure that this mechanism is not easily subjected to spoofing or replay attacks. Do not make this mechanism overly complex, which then may become subject to its own attack.
				</li>
				<li><b>Do not allow the login process to start from an unencrypted page.</b> Always start the login process from a second, encrypted page with a fresh or new session token to prevent credential or session stealing, phishing attacks and session fixation attacks.
				</li>
				<li>Consider <b>regenerating a new session upon successful authentication</b> or privilege level change.
				</li>
				<li><b>Ensure that every page has a logout link.</b> Logout should destroy all server side session state and client side cookies. Consider human factors: do not ask for confirmation as users will end up just closing the tab or window rather than logging out successfully.
				</li>
				<li><b>Use a timeout period</b> that automatically logs out an inactive session as per the value of the data being protected (shorter is always better). 
				</li>
				<li><b>Use only strong ancillary authentication functions</b> (questions and answers, password reset) as these are credentials in the same way usernames and passwords or tokens are credentials. Apply a one-One way hash to answers to prevent disclosure attacks.
				</li>
				<li><b>Do not expose any session identifiers or any portion of valid credentials in URLs or logs (no session rewriting or storing the userÃ¢ÂÂs password in log files)</b>
				</li>
				<li><b>Check the old password when the user changes to a new password</b>
				</li>
				<li><b>Do not rely upon spoofable credentials as the sole form of authentication</b>, such as IP addresses or address range masks, DNS  or reverse DNS lookups, referrer headers or similar<b> </b>
				</li>
				<li><b>Be careful of sending secrets to registered e-mail addresses</b> (see RSNAKE02 in the references) as a mechanism for password resets. Use limited time only random numbers to reset access and send a follow up e-mail as soon as the password has been reset. Be careful of allowing self-registered users changing their e-mail address - send a message to the previous e-mail address before enacting the change
				</li>
				</ul>
					<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Samples</p>   
				</div>
				<ul>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6145');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6145</a>    
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6229');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6229</a>      
				</li>
				<li><a id="hyperlink" href="javascript:loadURL('http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6528');">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-6528</a>     
				</li>
				</ul>
				<div class="decoration"></div>
				
				<div class="static-notification-blue">
					<p class="center-text uppercase">Related Articles</p>   
				</div>
			<ul>
			<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Guide_to_Authentication');" title="Guide to Authentication">Guide to Authentication</a>
			</li>
			<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_authentication');" title="Testing for authentication">Testing for authentication</a>
			</li>
			<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Reviewing_Code_for_Authentication');" title="Reviewing Code for Authentication">Reviewing Code for Authentication</a>
			</li>
			</ul>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>
				<ul>
				<li>CWE: CWE-287 (Authentication Issues), CWE-522 (Insufficiently Protected Credentials), CWE-301 (Reflection attack in an authentication protocol), others.
				</li>
				<li>WASC Threat Classification:
				<ul>
				<li> <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/insufficient_authentication.shtml');">http://www.webappsec.org/projects/threat/classes/insufficient_authentication.shtml</a>
				</li>
				<li> <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/credential_session_prediction.shtml');">http://www.webappsec.org/projects/threat/classes/credential_session_prediction.shtml</a>
				</li>
				<li> <a id="hyperlink" href="javascript:loadURL('http://www.webappsec.org/projects/threat/classes/session_fixation.shtml');">http://www.webappsec.org/projects/threat/classes/session_fixation.shtml</a>
				</li>
				</ul>
				</li>
				<li>RSNAKE01 - <a id="hyperlink" href="javascript:loadURL('http://ha.ckers.org/blog/20070122/ip-trust-relationships-xss-and-you');">http://ha.ckers.org/blog/20070122/ip-trust-relationships-xss-and-you</a>
				</li>
				<li>RSNAKE02 - <a id="hyperlink" href="javascript:loadURL('http://ha.ckers.org/blog/20061109/email-as-half-factor-authentication');">http://ha.ckers.org/blog/20061109/email-as-half-factor-authentication</a>
				</li>
				</ul>
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>