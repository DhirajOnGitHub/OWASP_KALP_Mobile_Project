<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A7: Missing Function Level Access Control</p>   
		</div>
		<div class="">
               <a class="checkbox checkbox-one" style="float:right;" onclick="toggleall();">Expand/Collapse</a>               
            </div>
       		<table class="table" id="desc-table">
			  <tbody>
				<tr onClick="toggle();"><th colspan="2" id="desc-table-header" ><a href="#" class="desc-table-header">Threat Agents</a></th></tr>
				<tr id="hidethis1"><th colspan="2" class="table-title-grey">Application Specific</th></tr>
				<tr id="hidethis11">
				<td colspan="2">
						Anyone with network access can send your application a request. Could anonymous users access private functionality or regular users a privileged function?
				</td></tr>
				
				<tr onClick="toggle2();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Attack Vectors</a></th></tr>
				<tr id="hidethis2"><th colspan="2" class="table-title-red">Exploitability EASY</th></tr>
				<tr id="hidethis22">
				<td colspan="2">
						Attacker, who is an authorized system user, simply changes the URL or a parameter to a privileged function. Is access granted? Anonymous users could access private functions that aren’t protected.
				</td></tr>
				
				<tr onClick="toggle3();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Security Weakness</a></th></tr>
				<tr id="hidethis3">
					<th class="table-title-orange">Prevalence COMMON</th><th class="table-title-orange">Detectability AVERAGE</th>
				</tr>
				<tr id="hidethis33">
				<td colspan="2">
					<p>Applications do not always protect application functions properly. Sometimes, function level protection is managed via configuration, and the system is misconfigured. Sometimes, developers must include the proper code checks, and they forget.
					</p>
					<p>
					Detecting such flaws is easy. The hardest part is identifying which pages (URLs) or functions exist to attack.
					</p>
				</td></tr>
				
				<tr onClick="toggle4();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Technical Impacts</a></th></tr>
				<tr id="hidethis4"><th colspan="2" class="table-title-orange">Impact MODERATE</th></tr>
				<tr id="hidethis44">
				<td colspan="2">
						Such flaws allow attackers to access unauthorized functionality. Administrative functions are key targets for this type of attack.
				</td></tr>
				
				<tr onClick="toggle5();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Business Impacts</a></th></tr>
				<tr id="hidethis5"><th colspan="2" class="table-title-grey">Application / Business Specific</th></tr>
				<tr id="hidethis55"><td colspan="2">
						<p>Consider the business value of the exposed functions and the data they process.
						</p><p>
						Also consider the impact to your reputation if this vulnerability became public.</p>
			    </td></tr>
			  </tbody>
			</table>
			
				<div class="static-notification-blue">
					<p class="center-text uppercase">Am I Vulnerable To 'Missing Function Level Access Control'?</p>   
				</div>				
					
					<p>The best way to find out if an application has failed to properly restrict function level access is to verify every application function:
					</p>
					<ol>
					<li> Does the UI show navigation to unauthorized functions?
					</li>
					<li> Are  server side authentication or authorization checks missing?
					</li>
					<li> Are server side checks done that solely rely on information provided by the attacker?
					</li>
					</ol>
					<p>Using a proxy, browse your application with a privileged role. Then revisit restricted pages using a less privileged role. If the server responses are alike, you're probably vulnerable. Some testing proxies directly support this type of analysis.
					</p><p>You can also check the access control implementation in the code. Try following a single privileged request through the code and verifying the authorization pattern. Then search the codebase to find where that pattern is not being followed.
					</p><p>Automated tools are unlikely to find these problems.
					</p>
				<div class="decoration"></div>
					
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">How Do I Prevent 'Missing Function Level Access Control'?</p>   
				</div>								
				<p>Your application should have a consistent and easy to analyze authorization module that is invoked from all of your business functions.  Frequently, such protection is provided by one or more components external to the application code. 
					</p>
					<ol>
					<li> Think about the process for managing entitlements and ensure you can update and audit easily. Don’t hard code.
					</li>
					<li> The enforcement mechanism(s) should deny all access by default, requiring explicit grants to specific roles for access to every function.
					</li>
					<li> If the function is involved in a workflow, check to make sure the conditions are in the proper state to allow access.
					</li>
					</ol>
					<p>NOTE: Most web applications don’t display links and buttons to unauthorized functions, but this “presentation layer access control” doesn’t actually provide protection. You must <u>also</u> implement checks in the controller or business logic.
					</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Example Scenarios</p>   
				</div>	
					
				
					<p><b>Scenario #1:</b> The attacker simply force browses to target URLs. The following URLs require authentication. Admin rights are also required for access to the <u>admin_getappInfo</u> page.
					</p>
					<div style="border: 2px dashed #444444; background-color: #E0E0E0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
					http://example.com/app/getappInfo<br />
					http://example.com/app/admin_getappInfo
					 </div>
					<p>If an unauthenticated user can  access either page, that’s a flaw. If an authenticated, non-admin, user is allowed to access the <u>admin_getappInfo</u> page, this is also a flaw, and may lead the attacker to more improperly protected admin pages.
					</p><p><b>Scenario #2:</b> A page provides an 'action' parameter to specify the function being invoked, and different actions require different roles. If these roles aren’t enforced, that’s a flaw.
					</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>				
					<p><b>OWASP</b>
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Top_10_2007-Failure_to_Restrict_URL_Access');">OWASP Top 10-2007 on Failure to Restrict URL Access</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessController.html');">ESAPI Access Control API</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Guide_to_Authorization');">OWASP Development Guide: Chapter on Authorization</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_Path_Traversal');">OWASP Testing Guide: Testing for Path Traversal</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Forced_browsing');">OWASP Article on Forced Browsing</a>
					</li>
					</ul>
					<p>For additional access control requirements, see the <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/ASVS');">ASVS requirements area for Access Control (V4)</a>.
					</p><p><b>External</b>
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/285.html');">CWE Entry 285 on Improper Access Control (Authorization)</a>
					</li>
					</ul>
				
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


