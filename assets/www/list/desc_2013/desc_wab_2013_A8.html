<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="../../images/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="../../images/splash-screen@2x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="../../images/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="./../images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="../../images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="../../images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css"     		 rel="stylesheet" type="text/css">
<link href="../../css/framework.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" 	 rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" 		 rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css"		 rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css"	 rel="stylesheet" type="text/css">
<link href="../../css/animate.css"		 rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

<div id="preloader" style="display: none;">
	<div id="status" style="display: none;">
    	<p class="center-text">
			Loading the content...
            <em>please wait...</em>
        </p>
    </div>
</div>


<div class="header">
    <a class="deploy-navigation going-up">
        <i class="fa fa-navicon"></i>
    </a>
    <a class="header-logo" href="../../index.html"><img src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
</div>

<div class="header-clear"></div>

<div class="page-navigation full-bottom">
	<div class="nav-clear"></div>
    <div class="nav-item">
        <a href="../../index.html">
            <i class="fa fa-star"></i>				
            Welcome		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
    <div class="nav-item">
        <a href="../../homepage.html">
            <i class="fa fa-home"></i>				
            Homepage		
            <i class="fa fa-angle-right"></i>
        </a>
    </div>
	<div class="nav-item">
        <a href="../../cheatsheets.html">
            <i class="fa fa-list-alt"></i>
            Cheat Sheets
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../email.html">
            <i class="fa fa-envelope"></i>
            Email OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="../../download.html">
            <i class="fa fa-cloud-download"></i>
            Download OWASP Top 10
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../about.html">
            <i class="fa fa-info"></i>
            About OWASP KALP
            <i class="fa fa-angle-right"></i>
        </a>
        
    </div>
    <div class="nav-item">
        <a href="../../tnc.html">
            <i class="fa fa-question-circle"></i>
            Disclaimer
            <i class="fa fa-angle-right"></i>
        </a>        
    </div>
    <div class="nav-item">
        <a href="../../contact.html">
            <i class="fa fa-phone-square"></i>
            Contact	
            <i class="fa fa-angle-right"></i>
        </a>       
    </div>
    <div class="nav-item">
        <a href="#" class="close-navigation">
            <i class="fa fa-times"></i>
            Close	
            <i class="fa fa-angle-up"></i>
        </a>       
    </div>
</div>    


<div class="content" id="content">     
    <div class="container">	
		<div class="static-notification-blue">
			<p class="center-text uppercase">A8: Cross-Site Request Forgery (CSRF)</p>   
		</div>
		<div class="">
               <a class="checkbox checkbox-one" style="float:right;" onclick="toggleall();">Expand/Collapse</a>               
            </div>
       		<table class="table" id="desc-table">
			  <tbody>
				<tr onClick="toggle();"><th colspan="2" id="desc-table-header" ><a href="#" class="desc-table-header">Threat Agents</a></th></tr>
				<tr id="hidethis1"><th colspan="2" class="table-title-grey">Application Specific</th></tr>
				<tr id="hidethis11">
				<td colspan="2">
						Consider anyone who can load content into your users’ browsers, and thus force them to submit a request to your website. Any website or other HTML feed that your users access could do this.
				</td></tr>
				
				<tr onClick="toggle2();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Attack Vectors</a></th></tr>
				<tr id="hidethis2"><th colspan="2" class="table-title-orange">Exploitability AVERAGE</th></tr>
				<tr id="hidethis22">
				<td colspan="2">
						Attacker creates forged HTTP requests and tricks a victim into submitting them via image tags, XSS, or numerous other techniques. If the user is authenticated, the attack succeeds.
				</td></tr>
				
				<tr onClick="toggle3();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Security Weakness</a></th></tr>
				<tr id="hidethis3">
					<th class="table-title-orange">Prevalence COMMON</th><th class="table-title-red">Detectability EASY</th>
				</tr>
				<tr id="hidethis33">
				<td colspan="2">
					<p>	<a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/CSRF');">CSRF</a> takes advantage the fact that most web apps allow attackers to predict all the details of a particular action.
				</p><p>Because browsers send credentials like session cookies automatically, attackers can create malicious web pages which generate forged requests that are indistinguishable from legitimate ones.
</p><p>
				Detection of CSRF flaws is fairly easy via penetration testing or code analysis.<p>
				</td></tr>
				
				<tr onClick="toggle4();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Technical Impacts</a></th></tr>
				<tr id="hidethis4"><th colspan="2" class="table-title-orange">Impact MODERATE</th></tr>
				<tr id="hidethis44">
				<td colspan="2">
						Attackers can trick victims into performing any state changing operation the victim is authorized to perform, e.g., updating account details, making purchases, logout and even login.
				</td></tr>
				
				<tr onClick="toggle5();"><th colspan="2" id="desc-table-header"><a href="#" class="desc-table-header">Business Impacts</a></th></tr>
				<tr id="hidethis5"><th colspan="2" class="table-title-grey">Application / Business Specific</th></tr>
				<tr id="hidethis55"><td colspan="2">
						<p>Consider the business value of the affected data or application functions. Imagine not being sure if users intended to take these actions.
</p><p>
Consider the impact to your reputation.</p>
			    </td></tr>
			  </tbody>
			</table>
			
				<div class="static-notification-blue">
					<p class="center-text uppercase">Am I Vulnerable To 'Cross-Site Request Forgery (CSRF)'?</p>   
				</div>				
					<p>To check whether an application is vulnerable, see if any links and forms lack an unpredictable CSRF token. Without such a token, attackers can forge malicious requests.  An alternate defense is to require the user to prove they intended to submit the request, either through reauthentication, or some other proof they are a real user (e.g., a CAPTCHA).
					</p><p>Focus on the links and forms that invoke state-changing functions, since those are the most important CSRF targets.
					</p><p>You should check multistep transactions, as they are not inherently immune. Attackers can easily forge a series of requests by using multiple tags or possibly JavaScript.
					</p><p>Note that session cookies, source IP addresses, and other information automatically sent by the browser don’t provide any defense against CSRF since this information is also included in forged requests.
					</p><p>OWASP’s <a rel="nofollow" class="external text" href="https://www.owasp.org/index.php/CSRFTester">CSRF Tester</a> tool can help generate test cases to demonstrate the dangers of CSRF flaws.
					</p>
				<div class="decoration"></div>
					
					
				<div class="static-notification-blue">
					<p class="center-text uppercase">How Do I Prevent 'Cross-Site Request Forgery (CSRF)'?</p>   
				</div>								
				<p>Preventing CSRF usually requires the inclusion of an unpredictable token in each HTTP request. Such tokens should, at a minimum, be unique per user session.
				</p>
				<ol>
				<li> The preferred option is to include the unique token in a hidden field. This causes the value to be sent in the body of the HTTP request, avoiding its inclusion in the URL, which is more prone to exposure.
				</li>
				<li> The unique token can also be included in the URL itself, or a URL parameter. However, such placement runs a greater risk that the URL will be exposed to an attacker, thus compromising the secret token.<br />OWASP’s <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/CSRFGuard');">CSRF Guard</a> can automatically include such tokens in Java EE, .NET, or PHP apps. OWASP’s <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/ESAPI');">ESAPI</a> includes methods developers can use to prevent CSRF vulnerabilities.
				</li>
				<li> Requiring the user to reauthenticate, or prove they are a user (e.g., via a CAPTCHA) can also protect against CSRF.
				</li>
				</ol>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">Example Scenarios</p>   
				</div>	
					<p>The application allows a user to submit a state changing request that does not include anything secret. For example:
					</p>
					<div style="border: 2px dashed #444444; background-color: #E0E0E0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
					<p>http://example.com/app/transferFunds?amount=1500&amp;destinationAccount=4673243243
					</p>
					</div>
					<p>So, the attacker constructs a request that will transfer money from the victim’s account to the attacker’s account, and then embeds this attack in an image request or iframe stored on various sites under the attacker’s control:
					</p>
					<div style="border: 2px dashed #444444; background-color: #E0E0E0; font-family: courier; padding: 4px;margin-left: +20px; margin-right: +20px;">
					<p>&lt;img src="<span style="color: red;">http://example.com/app/transferFunds?amount=1500&amp;destinationAccount=attackersAcct#</span>" width="0" height="0" /&gt;
					</p>
					</div>
					<p>If the victim visits any of the attacker’s sites while already authenticated to example.com, these forged requests will automatically include the user’s session info, authorizing the attacker’s request.
					</p>
				<div class="decoration"></div>
				<div class="static-notification-blue">
					<p class="center-text uppercase">References</p>   
				</div>				
					<p><b>OWASP</b>
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/CSRFGuard');">OWASP CSRF Article</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet');">OWASP CSRF Prevention Cheat Sheet</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/CSRFGuard');">OWASP CSRFGuard - CSRF Defense Tool</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/ESAPI');">ESAPI Project Home Page</a> 
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/HTTPUtilities.html');">ESAPI HTTPUtilities Class with AntiCSRF Tokens</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/Testing_for_CSRF_(OWASP-SM-005)');">OWASP Testing Guide: Chapter on CSRF Testing</a>
					</li>
					<li> <a id="hyperlink" href="javascript:loadURL('https://www.owasp.org/index.php/CSRFTester');">OWASP CSRFTester - CSRF Testing Tool</a>
					</li>
					</ul>
					<p><b>External</b>
					</p>
					<ul>
					<li> <a id="hyperlink" href="javascript:loadURL('http://cwe.mitre.org/data/definitions/352.html');">CWE Entry 352 on CSRF</a> 
					</li>
					</ul>
				
    </div>    
</div>
<div class="decoration"></div>
</body>
</html>


