<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport"
	content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black">

<link rel="apple-touch-icon-precomposed" sizes="114x114"
	href="../images/splash/splash-icon.png">
<link rel="apple-touch-startup-image"
	href="../../images/splash-screen.png"
	media="screen and (max-device-width: 320px)" />
<link rel="apple-touch-startup-image"
	href="../../images/splash-screen@2x.png"
	media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" />
<link rel="apple-touch-startup-image" sizes="640x1096"
	href="../../images/splash-screen@3x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748"
	href="../../images/splash-screen-ipad-landscape"
	media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004"
	href="./../images/splash/splash-screen-ipad-portrait.png"
	media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008"
	href="../../images/splash/splash-screen-ipad-portrait-retina.png"
	media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)" />
<link rel="apple-touch-startup-image" sizes="1496x2048"
	href="../../images/splash/splash-screen-ipad-landscape-retina.png"
	media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)" />

<title>OWASP TOP 10 Android App - Version 1.0</title>

<link href="../../css/style.css" rel="stylesheet" type="text/css">
<link href="../../css/framework.css" rel="stylesheet" type="text/css">
<link href="../../css/owl.carousel.css" rel="stylesheet" type="text/css">
<link href="../../css/owl.theme.css" rel="stylesheet" type="text/css">
<link href="../../css/swipebox.css" rel="stylesheet" type="text/css">
<link href="../../css/colorbox.css" rel="stylesheet" type="text/css">
<link href="../../css/font-awesome.css" rel="stylesheet" type="text/css">
<link href="../../css/animate.css" rel="stylesheet" type="text/css">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/jqueryui.js"></script>
<script type="text/javascript" src="../../js/wow.js"></script>
<script type="text/javascript" src="../../js/owl.carousel.min.js"></script>
<script type="text/javascript" src="../../js/jquery.swipebox.js"></script>
<script type="text/javascript" src="../../js/colorbox.js"></script>
<script type="text/javascript" src="../../js/snap.js"></script>
<script type="text/javascript" src="../../js/countdown.js"></script>
<script type="text/javascript" src="../../js/contact.js"></script>
<script type="text/javascript" src="../../js/framework.js"></script>
<script type="text/javascript" src="../../js/framework.launcher.js"></script>
<script type="text/javascript" src="../../js/custom.js"></script>
<script type="text/javascript" src="../../js/table.js"></script>
<script type="text/javascript" src="../../cordova.js"></script>
<script type="text/javascript" src="../../js/hyperlink.js"></script>
<script type="text/javascript" src="../../js/initialize.js"></script>

<script>


</script>
</head>
<body>

	<div id="preloader" style="display: none;">
		<div id="status" style="display: none;">
			<p class="center-text">
				Loading the content... <em>please wait...</em>
			</p>
		</div>
	</div>


	<div class="header">
		<a class="deploy-navigation going-up"> <i class="fa fa-navicon"></i>
		</a> <a class="header-logo" href="../../index.html"><img
			src="../../images/title/owasp_logo_header_1600_310.png" alt="img"></a>
	</div>

	<div class="header-clear"></div>

	<div class="page-navigation full-bottom">
		<div class="nav-clear"></div>
		<div class="nav-item">
			<a href="../../index.html"> <i class="fa fa-star"></i> Welcome <i
				class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="../../homepage.html"> <i class="fa fa-home"></i>
				Homepage <i class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="../../cheatsheets.html"> <i class="fa fa-list-alt"></i>
				Cheat Sheets <i class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="../../email.html"> <i class="fa fa-envelope"></i> Email
				OWASP Top 10 <i class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="../../download.html"> <i class="fa fa-cloud-download"></i>
				Download OWASP Top 10 <i class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="../../about.html"> <i class="fa fa-info"></i> About
				OWASP KALP <i class="fa fa-angle-right"></i>
			</a>

		</div>
		<div class="nav-item">
			<a href="../../tnc.html"> <i class="fa fa-question-circle"></i>
				Disclaimer <i class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="../../contact.html"> <i class="fa fa-phone-square"></i>
				Contact <i class="fa fa-angle-right"></i>
			</a>
		</div>
		<div class="nav-item">
			<a href="#" class="close-navigation"> <i class="fa fa-times"></i>
				Close <i class="fa fa-angle-up"></i>
			</a>
		</div>
	</div>


	<div class="content" id="content">
		<div class="container">
			<div class="static-notification-blue">
				<p class="center-text uppercase">A4: Insecure Direct Object
					References</p>
			</div>
			<div class="">
				<a class="checkbox checkbox-one" style="float: right;"
					onclick="toggleall();">Expand/Collapse</a>
			</div>
			<table class="table" id="desc-table">
				<tbody>
					<tr onClick="toggle();">
						<th colspan="2" id="desc-table-header"><a href="#"
							class="desc-table-header">Threat Agents</a></th>
					</tr>
					<tr id="hidethis1">
						<th colspan="2" class="table-title-grey">Application Specific</th>
					</tr>
					<tr id="hidethis11">
						<td colspan="2">Consider the types of users of your system.
							Do any users have only partial access to certain types of system
							data?</td>
					</tr>

					<tr onClick="toggle2();">
						<th colspan="2" id="desc-table-header"><a href="#"
							class="desc-table-header">Attack Vectors</a></th>
					</tr>
					<tr id="hidethis2">
						<th colspan="2" class="table-title-red">Exploitability EASY</th>
					</tr>
					<tr id="hidethis22">
						<td colspan="2">Attacker, who is an authorized system user,
							simply changes a parameter value that directly refers to a system
							object to another object the user isn’t authorized for. Is access
							granted?</td>
					</tr>

					<tr onClick="toggle3();">
						<th colspan="2" id="desc-table-header"><a href="#"
							class="desc-table-header">Security Weakness</a></th>
					</tr>
					<tr id="hidethis3">
						<th class="table-title-orange" style="width: 50%;">Prevalence
							COMMON</th>
						<th class="table-title-red">Detectability EASY</th>
					</tr>
					<tr id="hidethis33">
						<td colspan="2">Applications frequently use the actual name
							or key of an object when generating web pages. Applications don’t
							always verify the user is authorized for the target object. This
							results in an insecure direct object reference flaw. Testers can
							easily manipulate parameter values to detect such flaws. Code
							analysis quickly shows whether authorization is properly
							verified.</td>
					</tr>

					<tr onClick="toggle4();">
						<th colspan="2" id="desc-table-header"><a href="#"
							class="desc-table-header">Technical Impacts</a></th>
					</tr>
					<tr id="hidethis4">
						<th colspan="2" class="table-title-orange">Impact MODERATE</th>
					</tr>
					<tr id="hidethis44">
						<td colspan="2">Such flaws can compromise all the data that
							can be referenced by the parameter. Unless object references are
							unpredictable, it’s easy for an attacker to access all available
							data of that type.</td>
					</tr>

					<tr onClick="toggle5();">
						<th colspan="2" id="desc-table-header"><a href="#"
							class="desc-table-header">Business Impacts</a></th>
					</tr>
					<tr id="hidethis5">
						<th colspan="2" class="table-title-grey">Application /
							Business Specific</th>
					</tr>
					<tr id="hidethis55">
						<td colspan="2">
							<p>Consider the business value of the exposed data.</p>
							<p>Also consider the business impact of public exposure of
								the vulnerability</p>
						</td>
					</tr>
				</tbody>
			</table>

			<div class="static-notification-blue">
				<p class="center-text uppercase">Am I Vulnerable To 'Insecure
					Direct Object References'?</p>
			</div>

			<p>
				The best way to find out if an application is vulnerable to insecure
				direct object references is to verify that <u>all</u> object
				references have appropriate defenses. To achieve this, consider:
			</p>
			<ol>
				<li>For <b>direct</b> references to <b>restricted</b>
					resources, does the application fail to verify the user is
					authorized to access the exact resource they have requested?
				</li>
				<li>If the reference is an <b>indirect</b> reference, does the
					mapping to the direct reference fail to limit the values to those
					authorized for the current user?
				</li>
			</ol>
			<p>Code review of the application can quickly verify whether
				either approach is implemented safely. Testing is also effective for
				identifying direct object references and whether they are safe.
				Automated tools typically do not look for such flaws because they
				cannot recognize what requires protection or what is safe or unsafe.
			</p>
			<div class="decoration"></div>


			<div class="static-notification-blue">
				<p class="center-text uppercase">How Do I Prevent 'Insecure
					Direct Object References'?</p>
			</div>
			<p>Preventing insecure direct object references requires
				selecting an approach for protecting each user accessible object
				(e.g., object number, filename):</p>
			<ol>
				<li><b>Use per user or session indirect object references.</b>
					This prevents attackers from directly targeting unauthorized
					resources. For example, instead of using the resource’s database
					key, a drop down list of six resources authorized for the current
					user could use the numbers 1 to 6 to indicate which value the user
					selected. The application has to map the per-user indirect
					reference back to the actual database key on the server. OWASP’s <a
					id="hyperlink"
					href="javascript:loadURL('https://www.owasp.org/index.php/ESAPI');">ESAPI</a>
					includes both sequential and random access reference maps that
					developers can use to eliminate direct object references.</li>
				<li><b>Check access.</b> Each use of a direct object reference
					from an untrusted source must include an access control check to
					ensure the user is authorized for the requested object.</li>
			</ol>
			<div class="decoration"></div>
			<div class="static-notification-blue">
				<p class="center-text uppercase">Example Scenarios</p>
			</div>


			<p>The application uses unverified data in a SQL call that is
				accessing account information:</p>
			<div
				style="border: 2px dashed #444444; background-color: #E0E0E0; font-family: courier; padding: 4px; margin-left: +20px; margin-right: +20px;">
				<p>String query = "SELECT * FROM accts WHERE account =&#160;?";
				</p>
				<p>PreparedStatement pstmt = connection.prepareStatement(query ,
					… );</p>
				<p>
					<span style="color: red;">pstmt.setString( 1,
						request.getParameter("acct"));</span>
				</p>
				<p>ResultSet results = pstmt.executeQuery( );</p>
			</div>
			<p>The attacker simply modifies the ‘acct’ parameter in their
				browser to send whatever account number they want. If not verified,
				the attacker can access any user’s account, instead of only the
				intended customer’s account.</p>
			<div
				style="border: 2px dashed #444444; background-color: #E0E0E0; font-family: courier; padding: 4px; margin-left: +20px; margin-right: +20px;">
				<p>
					http://example.com/app/accountInfo?acct=<span style="color: red;">notmyacct</span>
				</p>
			</div>
			<div class="decoration"></div>
			<div class="static-notification-blue">
				<p class="center-text uppercase">References</p>
			</div>
			<p>
				<b>OWASP</b>
			</p>
			<ul>
				<li><a id="hyperlink"
					href="javascript:loadURL('https://www.owasp.org/index.php/Top_10_2007-Insecure_Direct_Object_Reference');">OWASP
						Top 10-2007 on Insecure Dir Object References</a></li>
				<li><a id="hyperlink"
					href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessReferenceMap.html');">ESAPI
						Access Reference Map API</a></li>
				<li><a id="hyperlink"
					href="javascript:loadURL('http://owasp-esapi-java.googlecode.com/svn/trunk_doc/latest/org/owasp/esapi/AccessController.html');">ESAPI
						Access Control API</a> (See isAuthorizedForData(),
					isAuthorizedForFile(), isAuthorizedForFunction() )</li>
			</ul>
			<p>
				For additional access control requirements, see the <a
					id="hyperlink"
					href="javascript:loadURL('https://www.owasp.org/index.php/ASVS');">ASVS
					requirements area for Access Control (V4)</a>.
			</p>
			<p>
				<b>External</b>
			</p>
			<ul>
				<li><a id="hyperlink"
					href="javascript:loadURL('http://cwe.mitre.org/data/definitions/639.html');">CWE
						Entry 639 on Insecure Direct Object References</a></li>
				<li><a id="hyperlink"
					href="javascript:loadURL('http://cwe.mitre.org/data/definitions/22.html');">CWE
						Entry 22 on Path Traversal</a> (is an example of a Direct Object
					Reference attack)</li>
			</ul>

		</div>
	</div>
	<div class="decoration"></div>
</body>
</html>


